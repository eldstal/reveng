!function(a){var b,c,d,e;define(function(require,a,f){b=require("jsCore/pageBase"),c=require("jsCore/rpc"),d=require("jsCore/ability"),require("jsCore/modules/eventHandler"),e=require("jsCore/modules/timeSection"),f.exports=require("jsCore/pageTab"),f.exports.prototype.ala_pir=d.is("AlarmPir"),f.exports.prototype.ala_Link=d.is("AlarmPir").then(function(a){return!a||1!==webApp.ALARM_IN_NUMBER}),f.exports.prototype.ala_flash=d.is("Flash"),f.exports.prototype.ala_wireless=d.get("WirelessAlarm").then(function(a){return a&&a.Support}),f.exports.prototype.ala_emergency=d.get("WirelessAlarm").then(function(a){return a&&a.Support}),f.exports.prototype.ala_audioDetect=d.get("AudioFileManager").then(function(a){return a&&a.Support&&webApp.AUDIO_IN_NUMBER})}),define("ala_pir",function(require,a,f){var g,h,i=null,j=webApp.ALARM_IN_NUMBER-1;f.exports=b.extend({init:function(){i=this,i.$("#ala_pirEventHandler").eventHandler(),h=i.$("#ala_pirDejitter").numberfield({max:100,min:0,allowDecimal:!1,allowNegative:!1}),i.render()},render:function(){i._getConfig(),$$("[data-page=ala_pir]").getElementById("e_recordchn").addClass("fn-hide")},_getConfig:function(a){c.ConfigManager.getConfig("Alarm").done(function(b){g=b,i._renderValue(),a&&i.tip("success","Operateingsuccess")}).fail(function(){a&&i.tip("error","Operateingfailure")})},_renderValue:function(){var a=g[j];i.$("#ala_pirEnable").prop("checked",a.Enable),h.numberfield("value",a.EventHandler.Dejitter),i.$("#ala_pirEventHandler").eventHandler("set",a.EventHandler)},onWorkPeriod:function(){e.open(g[j].EventHandler.TimeSection).done(function(a){g[j].EventHandler.TimeSection=a})},onRefresh:function(){i._getConfig(!0)},onDefault:function(){c.ConfigManager.getDefault("Alarm").done(function(a){d.is("AlarmPir").done(function(){g[j]=a[j]}),i._renderValue(),i.tip("success","Defaultsuccess")}).fail(function(){i.tip("error","Defaultfailure")})},onSave:function(){var a=g[j];a.Enable=i.$("#ala_pirEnable").prop("checked"),a.EventHandler=i.$("#ala_pirEventHandler").eventHandler("get"),a.EventHandler.Dejitter=h.numberfield("value"),c.ConfigManager.setConfig("Alarm",g).done(function(){i.tip("success","Succeed in saving configure")}).fail(function(){i.tip("error","Saving failure")})}})}),define("ala_Link",function(require,f,g){var h,i,j,k=null,l=0;g.exports=b.extend({init:function(){k=this,i=k.$('[sel-for="onSelAlarmIn"]'),k.$("#ala_LinkEventHandler").eventHandler(),j=k.$("#ala_LinkDejitter").numberfield({max:100,min:0,allowDecimal:!1,allowNegative:!1}),k.render()},render:function(){i.empty(),d.is("AlarmPir").done(function(b){for(var c=b?webApp.ALARM_IN_NUMBER-1:webApp.ALARM_IN_NUMBER,d=0;c>d;d++)a("<option value="+d+"></option>").text(tl("w_Alarm")+(d+1)).appendTo(i);l=i.val(),k._getConfig()}),$$("[data-page=ala_Link]").getElementById("e_snapchn").addClass("fn-hide"),$$("[data-page=ala_Link]").getElementById("e_recordchn").addClass("fn-hide")},_getConfig:function(a){c.ConfigManager.getConfig("Alarm").done(function(b){h=b,k._renderValue(),a&&k.tip("success","Operateingsuccess")}).fail(function(){a&&k.tip("error","Operateingfailure")})},_renderValue:function(){var a=h[l];k.$("#ala_LinkEnable").prop("checked",a.Enable),j.numberfield("value",a.EventHandler.Dejitter),k.$("#ala_LinkSensorModel").val(a.SensorType),k.$("#ala_LinkEventHandler").eventHandler("set",a.EventHandler)},onWorkPeriod:function(){e.open(h[l].EventHandler.TimeSection).done(function(a){h[l].EventHandler.TimeSection=a})},onSelAlarmIn:function(){k._saveTempJson(),l=i.val(),k._renderValue()},onRefresh:function(){k._getConfig(!0)},onDefault:function(){c.ConfigManager.getDefault("Alarm").done(function(a){d.is("AlarmPir").done(function(b){for(var c=b?webApp.ALARM_IN_NUMBER-1:webApp.ALARM_IN_NUMBER,d=0;c>d;d++)h[d]=a[d];k._renderValue(),k.tip("success","Defaultsuccess")})}).fail(function(){k.tip("error","Defaultfailure")})},_saveTempJson:function(){var a=h[l];a.Enable=k.$("#ala_LinkEnable").prop("checked"),a.EventHandler=k.$("#ala_LinkEventHandler").eventHandler("get"),a.EventHandler.Dejitter=j.numberfield("value"),a.EventHandler.SnapshotChannels=[0],a.EventHandler.RecordChannels=[0],a.EventHandler.ExAlarmOutChannels=[0],a.SensorType=k.$("#ala_LinkSensorModel").val()},onSave:function(){k._saveTempJson(),c.ConfigManager.setConfig("Alarm",h).done(function(){k.tip("success","Succeed in saving configure")}).fail(function(){k.tip("error","Saving failure")})}})}),define("ala_flash",function(require,d,e){function f(a){return a.find("input:checked").length===a.find("input").length}function g(b,c){var d=b.prop("checked");c.find("input").each(function(b,c){a(c).prop("checked",d)})}require("widget/js/dui.slider");var h,i,j,k,l,m,n=null;e.exports=b.extend({init:function(){n=this,j=n.$("#ala_falseEnable"),k=n.$("#ala_flashWeek"),l=n.$("#ala_flashAllWeek"),n.$("#ala_flashBrightness").slider({min:0,max:100,prompt:!1,change:function(a,b){m.Brightness=b.value},complete:function(a,b){m.Brightness=b.value}}),l.on("click",function(){g(l,k)}),k.on("click",function(){l.prop("checked",f(k))}),h=n.$("#ala_flashTime0").timefield(),i=n.$("#ala_flashTime1").timefield(),j.on("click",function(){n._onFlashEnable()}),n.render()},render:function(){n._getConfig(),$$("[data-page=ala_flash]").getElementById("e_recordchn").addClass("fn-hide")},_getConfig:function(a){c.ConfigManager.getConfig("FlashLight").done(function(b){m=b,n._renderValue(),a&&n.tip("success","Operateingsuccess")}).fail(function(){a&&n.tip("error","Operateingfailure")})},_renderValue:function(){m.Enable?j.addClass("alarmconfig-flashbtn-on"):j.removeClass("alarmconfig-flashbtn-on"),n.$("#ala_flashBrightness").slider("value",m.Brightness);var b,c=k.find("input");n.$("#ala_flashPeriod").prop("checked",!0);for(var d=0;7>d;d++){var e=m.TimeSection[d],g=a.trim(e[0]).split(" ");getBitEx(g[0],0)?(b=g[1].split("-"),a(c[d]).prop("checked",!0),n.$("#ala_flashPeriod").prop("checked",!0)):a(c[d]).prop("checked",!1)}l.prop("checked",f(k)),i.timefield("value",b[0]),i.timefield("value",b[1])},_onFlashEnable:function(){m.Enable=!0,j.hasClass("alarmconfig-flashbtn-on")&&(m.Enable=!1),j.toggleClass("alarmconfig-flashbtn-on"),c.ConfigManager.setConfig("FlashLight",m).done(function(){})},onRefresh:function(){n._getConfig(!0)},onDefault:function(){c.ConfigManager.getDefault("FlashLight").done(function(a){m=a,n._renderValue(),n.tip("success","Defaultsuccess")}).fail(function(){n.tip("error","Defaultfailure")})},onSave:function(){var b=h.timefield("value"),d=i.timefield("value"),e=n.$("#ala_flashPeriod").prop("checked");k.find("input").each(function(c,f){m.TimeSection[c][0]=(a(f).prop("checked")&&e?"1 ":"0 ")+b+"-"+d}),c.ConfigManager.setConfig("FlashLight",m).done(function(){n.tip("success","Succeed in saving configure")}).fail(function(){n.tip("error","Saving failure")})}})}),define("ala_wireless",function(require,d,f){var g,h,i,j=null,k=0;f.exports=b.extend({init:function(){j=this,i=j.$("#ala_wireDejitter").numberfield({max:100,min:0,allowDecimal:!1,allowNegative:!1}),j.$("#ala_wireEventHandler").eventHandler(),h=j.$("#ala_wireName"),j._initWireName(),j.render()},_initWireName:function(){h.empty();for(var b=0;b<webApp.ALARM_IN_NUMBER;b++)a("<option value="+b+"></option>").text(b+1).appendTo(h);k=h.val()},render:function(){j._getConfig()},_getConfig:function(a){c.ConfigManager.getConfig("ExAlarm").done(function(b){g=b,j._renderValue(),a&&j.tip("success","Operateingsuccess")}).fail(function(){a&&j.tip("error","Operateingfailure")})},_renderValue:function(){var a=g[k];j.$("#ala_wireEnable").prop("checked",a.Enable),j.$("#ala_wireCustomName").val(a.Name),i.numberfield("value",a.EventHandler.Dejitter),j.$("#ala_wireEventHandler").eventHandler("set",a.EventHandler)},onWorkPeriod:function(){e.open(g[k].EventHandler.TimeSection).done(function(a){g[k].EventHandler.TimeSection=a})},onSelWireName:function(){j._saveTempJson(),k=h.val(),j._renderValue()},onRefresh:function(){j._getConfig(!0)},onDefault:function(){c.ConfigManager.getDefault("ExAlarm").done(function(a){g=a,j._renderValue(),j.tip("success","Defaultsuccess")}).fail(function(){j.tip("error","Defaultfailure")})},_saveTempJson:function(){var a=g[k];a.Enable=j.$("#ala_wireEnable").prop("checked"),a.Name=j.$("#ala_wireCustomName").val(),a.EventHandler=j.$("#ala_wireEventHandler").eventHandler("get"),a.EventHandler.Dejitter=i.numberfield("value")},onSave:function(){j._saveTempJson(),c.ConfigManager.setConfig("ExAlarm",g).done(function(){j.tip("success","Succeed in saving configure")}).fail(function(){j.tip("error","Saving failure")})}})}),define("ala_audioDetect",function(require,a,d){var f,g,h=null;require("widget/js/dui.slider"),d.exports=b.extend({init:function(){h=this,h.$("#ala_audioThreshold").slider({min:0,max:100,change:function(a,b){f[0].MinVolume=b.value},complete:function(a,b){f[0].MinVolume=b.value}}),g=h.$("#ala_audioDejitter").numberfield({max:100,min:0,allowDecimal:!1,allowNegative:!1}),h.$("#ala_audioEventHandler").eventHandler(),h.render()},render:function(){h._getConfig()},_getConfig:function(a){c.ConfigManager.getConfig("AudioDetect").done(function(b){f=b,h._renderValue(),a&&h.tip("success","Operateingsuccess")}).fail(function(){a&&h.tip("error","Operateingfailure")})},_renderValue:function(){var a=f[0];h.$("#ala_audioEnable").prop("checked",a.Enable),h.$("#ala_audioThreshold").slider("value",a.MinVolume),g.numberfield("value",a.EventHandler.Dejitter),h.$("#ala_audioEventHandler").eventHandler("set",a.EventHandler)},onWorkPeriod:function(){e.open(f[0].EventHandler.TimeSection).done(function(a){f[0].EventHandler.TimeSection=a})},onRefresh:function(){h._getConfig(!0)},onDefault:function(){c.ConfigManager.getDefault("AudioDetect").done(function(a){f=a,h._renderValue(),h.tip("success","Defaultsuccess")}).fail(function(){h.tip("error","Defaultfailure")})},onSave:function(){var a=f[0];a.Enable=h.$("#ala_audioEnable").prop("checked"),a.EventHandler=h.$("#ala_audioEventHandler").eventHandler("get"),a.EventHandler.Dejitter=g.numberfield("value"),c.ConfigManager.setConfig("AudioDetect",f).done(function(){h.tip("success","Succeed in saving configure")}).fail(function(){h.tip("error","Saving failure")})}})}),define("ala_emergency",function(require,a,d){var e,f=null;d.exports=b.extend({init:function(){f=this,f.$("#ala_emerEventHandler").eventHandler(),f.render()},render:function(){f._getConfig()},_getConfig:function(a){c.ConfigManager.getConfig("RemoteCtrl.EventHandlerList").done(function(b){e=b,f._renderValue(),a&&f.tip("success","Operateingsuccess")}).fail(function(){a&&f.tip("error","Operateingfailure")})},_renderValue:function(){f.$("#ala_emerEventHandler").eventHandler("set",e[0].EventHandler)},onRefresh:function(){f._getConfig(!0)},onDefault:function(){c.ConfigManager.getDefault("RemoteCtrl.EventHandlerList").done(function(a){e=a,f._renderValue(),f.tip("success","Defaultsuccess")}).fail(function(){f.tip("error","Defaultfailure")})},onSave:function(){e[0].EventHandler=f.$("#ala_emerEventHandler").eventHandler("get"),c.ConfigManager.setConfig("RemoteCtrl.EventHandlerList",e).done(function(){f.tip("success","Succeed in saving configure")}).fail(function(){f.tip("error","Saving failure")})}})})}(jQuery);