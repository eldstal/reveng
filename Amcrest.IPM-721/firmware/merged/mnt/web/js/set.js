!function(a){define(function(require,b,c){function d(b){if(-1===webApp.DeviceType.indexOf("TPC")||advanceSet.checkAdvAuth(this)){var c=a(b.currentTarget);return c.hasClass(n)?c.removeClass(n).next("ul").hide():(p.menuElem.find(".set-menu").removeClass(n).next("ul").hide(),c.addClass(n).next("ul").show()),!1}}function e(b){var c=a(b.currentTarget),d=p.menuElem.find(".set-item."+o),e=d.data("page");p.menuCont.find('[data-for="'+d.attr("filename")+'"]').hide(),c.attr("filename")!=d.attr("filename")&&e&&a.isFunction(e.leave)&&e.leave(),p.menuElem.find(".set-item").removeClass(o),c.addClass(o);var f=c.data("page"),g=c.attr("filename");if(Site.currentPage.is={},Site.currentPage.is[g]=!0,f)f.element.show(),f.render();else{var h=a('<div id="page_'+g+'" data-for="'+g+'"></div>');h.appendTo(p.menuCont);var i,j;"vsp"===c.attr("vsp")?(i="platformHtm/"+g+".js"+q,j="platformHtm/"+g+".htm"+q):(i="js/"+g+".js"+q,j="html/"+g+".htm"+q),require.async([i,j],function(b,d){if(h.html(d).translation(),a.isFunction(b))c.data("page",new b({element:h}));else{if(Page[g].element=h,Page&&Page[g]&&Page[g].init&&Page[g].init(),Page&&Page[g]&&Page[g].translate&&Page[g].translate(),Page[g].Tab)for(var e in Page[g].Tab)Page[g].Tab[e].translate&&Page[g].Tab[e].translate();c.data("page",Page[g])}})}}function f(b){var c=[];a.each(b,function(b,d){d.condition===!1?p.menuElem.find("li[category="+d.category+"]").remove():(p.menuElem.find("li[category="+d.category+"]").show(),a.each(d.member,function(b,d){if(void 0!==d.condition){var e=p.menuElem.find("li[filename="+d.filename+"]"),f=d.condition;"function"===a.type(f)&&(f=f()),"boolean"===a.type(f)?f?e.show():e.remove():"function"===a.type(f.done)&&(f.done(function(a){a?e.show():e.remove()}),c.push(f))}}))}),a.when.apply(null,c).always(function(){p.menuElem.find("ul:not(:has(li))").closest("li").remove(),webApp.dandan?(p.menuElem.find('[category="system"] a.set-menu').click(),p.menuElem.find('[filename="upgradeConfig"]').click()):(p.menuElem.find(".set-menu:first").click(),p.menuElem.find(".set-item:first").click()),-1!==webApp.DeviceType.indexOf("TPC")&&advanceSet.init()})}function g(b){for(var c=a.extend(!0,[],b),d=0;d<c.length;d++){for(var e=c[d].member,f=0;f<e.length;f++)e[f].authority&&!l.chkAuthority(e[f].authority)&&e.splice(f--,1);0===e.length&&c.splice(d--,1)}return c}function h(){return[{category:"camera",t:"w_Camera Setup",member:[{filename:webCaps.is_show_QT_VidAnalyse_VidInAttr||webApp.DeviceType.contains("TPC")?"cameraNewConfig":"cameraConfig",t:"w_Camera Attribute",authority:"VideoInputConfig",condition:j.get("CameraAttribute").then(function(a){return-1===webApp.DeviceType.indexOf("SD")&&-1===webApp.DeviceType.indexOf("CA-")?!0:a&&a.Support})},{filename:"encodeConfig",t:"w_Video",authority:"EncodeConf"},{filename:"audioConfig",t:"w_Audio",authority:"EncodeConf",condition:i.DevAudioInput.getCollect().then(function(a){return a&&!isEnable("is_8M_Flash")})}]},{category:"sdIVS",t:"w_IVS Set",condition:!!webApp.IsSDTraficIntel,member:[{filename:"ivsSDConfig",t:"w_IVS Set",authority:"IntelliConf",condition:!!webApp.IsSDTraficIntel},{filename:"ivsTrafficConfig",t:"advancedParams",authority:"IntelliConf",condition:!!webApp.IsSDTraficIntel},{filename:"ivsTrafficDefault",t:"w_DefaultConfig",authority:"IntelliConf",condition:!!webApp.IsSDTraficIntel}]},{category:"network",t:"w_Network Settings",member:[{filename:"networkConfig",t:"w_TCP/IP Settings",authority:"NetConf"},{filename:"connetConfig",t:"w_Connect Settings",authority:"NetConf"},{filename:"DDNSConfig",t:"w_DDNS Settings",authority:"NetConf"},{filename:"ipAuthorityConfig",t:"w_IP Purview",authority:"NetConf"},{filename:"emailConfig",t:"w_Mail Settings",authority:"NetConf"},{filename:"UPnPConfig",t:"w_UPNP",authority:"NetConf"},{filename:"SNMPConfig",t:"w_SNMPv1/v2",authority:"NetConf",condition:!(!isEnable("show_SNMP_config")||isEnable("is_8M_Flash"))},{filename:"bonjourConfig",t:"w_Bonjour",authority:"NetConf",condition:!!isEnable("show_bonjour_config")},{filename:"broadcastConfig",t:"w_Multicast",authority:"NetConf"},{filename:"autoRegisterConfig",t:"w_Auto Register",authority:"NetConf",condition:!(!isEnable("show_auto_register")||!/simpchinese/i.test(k.get("DHLangCookie30")))},{filename:"wifiConfig",t:"w_WIFI",authority:"NetConf",condition:j.is("WIFI").then(function(a){return webApp.WIFI=a,a&&!isEnable("is_8M_Flash")})},{filename:"IEEE802",t:"w_IEEE802",authority:"NetConf",condition:j.get("IEEE802_1X").then(function(a){return a&&!isEnable("is_8M_Flash")})},{filename:"VPNConfig",t:"w_VPN Settings",authority:"NetConf",condition:j.get("VPN").then(function(a){return a&&!isEnable("is_8M_Flash")})},{filename:"LDAPConfig",t:"w_ldap",authority:"NetConf",condition:!(!isEnable("is_show_LDAP")||isEnable("is_8M_Flash"))},{filename:"QoSConfig",t:"w_QOS",authority:"NetConf"},{filename:"3gnetConfig",t:webApp.Is4G?"w_4G":"w_3G",authority:"NetConf",condition:webApp.Is4G||webApp.Is3G},{filename:"platformConfig",t:"w_access_platform",authority:"NetConf",condition:!(!isEnable("is_show_platform")||!/simpchinese/i.test(k.get("DHLangCookie30")))},{filename:"ATMConfig",t:"w_ATMOsd",condition:!(!isEnable("show_ATM_config")||isEnable("is_8M_Flash"))},{filename:"httpsConfig",t:"Https",condition:!!isEnable("is_show_HTTPS"),authority:"NetConf"},{filename:"RTSPConfig",t:"RTSP",condition:!!webApp.GongAnDetect}]},{category:"ptz",t:"Set PTZ",condition:-1!==webApp.DeviceType.indexOf("SD"),member:[{filename:"ptzConfigSD",t:"w_Protocol",authority:"PtzConfig",condition:a.when(j.get("HasPtz"),j.get("PTZFunctionViaApp")).then(function(a,b){return b?!1:a})},{filename:"functioncfg",t:"w_Function",authority:"MPTZ",condition:j.get("PtzFunctionMenu").then(function(a){return a&&a.Support})}]},{category:"smartThermal",t:"smartThermal",condition:-1!==webApp.DeviceType.indexOf("TPC"),member:[{filename:webCaps.is_new_IVSUI?"ivsConfig":"ipcIntellentNewConfig",t:"w_IVS_Analyse",authority:"IntelliConf",condition:a.when(j.get("IVSCaps"),j.is("DSPConflict",!0)).then(function(b,c){return!c&&(webCaps.is_new_IVSUI?!0:webApp.IsIPCIntel)&&b&&-1!==a.inArray("Normal",b.SupportedScene)})},{filename:"ipcFaceNewConfig",t:"w_faceDetection",authority:"IntelliConf",condition:j.get("IVSCaps").then(function(b){return(webCaps.is_new_IVSUI?!0:webApp.IsIPCIntel)&&b&&-1!==a.inArray("FaceDetection",b.SupportedScene)})},{filename:"fireAlarmConfig",t:"fireAlarm",authority:"FireWarning",condition:j.get("FireWarning").then(function(a){return!(!a||!a.Support)})},{filename:"hotspoConfig",t:"w_hotspoConfig",authority:"HotTrace"},{filename:"picInpicConfig",t:"w_picInpic",authority:"PicInPic",condition:webApp.CHANNEL_NUMBER>1},{filename:"thermalLinkConfig",t:"thermalLink",condition:webApp.CHANNEL_NUMBER>1&&webApp.DeviceType.indexOf("SD")&&(l.chkAuthority("FireWarning")||l.chkAuthority("HotTrace"))},{filename:"autoFocusConfig",t:"w_autoFocus",condition:a.when(j.get("PresetFocusROI"),j.get("IntelligentFocus")).then(function(a,b){return a&&a.Support&&b&&a.Support})}]},{category:"event",t:"w_Event manage",member:[{filename:"videoDetectConfig",t:"w_Video Check",authority:"VideoConfig"},{filename:"alarmAudioConfig",t:"w_audioDetect",authority:"VideoConfig",condition:a.when(j.get("VolumeDetect"),j.get("AnomalyDetect"),j.get("MutationDetect"),i.DevAudioInput.getCollect()).then(function(){return(arguments[0]||arguments[1]||arguments[2])&&arguments[3]})},{filename:"iExclusionConfig",t:"ivsScheme",authority:"IntelliConf",condition:a.when(j.get("IVSCaps"),j.is("DSPConflict",!0)).then(function(){return!1})},{filename:webCaps.is_new_IVSUI?"ivsConfig":"ipcIntellentNewConfig",t:"w_IVS_Analyse",authority:"IntelliConf",condition:a.when(j.get("IVSCaps"),j.is("DSPConflict",!0)).then(function(b,c){return!c&&(webCaps.is_new_IVSUI?!0:webApp.IsIPCIntel)&&b&&-1!==a.inArray("Normal",b.SupportedScene)})},{filename:"ipcFaceNewConfig",t:"w_faceDetection",authority:"IntelliConf",condition:a.when(j.get("IVSCaps"),j.is("DSPConflict",!0)).then(function(b,c){return!c&&(webCaps.is_new_IVSUI?!0:webApp.IsIPCIntel)&&b&&(-1!==a.inArray("FaceDetection",b.SupportedScene)||-1!==a.inArray("SDFaceDetect",b.SupportedScene))})},{filename:"flowrateConfig",t:"w_flowrate",authority:"IntelliConf",condition:a.when(j.get("IVSCaps"),j.is("DSPConflict")).then(function(b,c){return!c&&webApp.IsIPCIntel&&b&&-1!==a.inArray("NumberStat",b.SupportedScene)})},{filename:"ipcShootingScore",t:"ShootingScoreRecognition",authority:"IntelliConf",condition:a.when(j.get("IVSCaps"),j.is("DSPConflict")).then(function(b,c){return!c&&webApp.IsIPCIntel&&b&&-1!==a.inArray("SCR",b.SupportedScene)})},{filename:"temperAlarmConfig",t:"TemperatureAlarm",authority:"TemperatureConfig",condition:-1!==webApp.DeviceType.indexOf("TPC")},{filename:"ipcHeatMapConfig",t:"heatMap",authority:"IntelliConf",condition:a.when(j.get("IVSCaps"),j.is("DSPConflict")).then(function(b,c){return!c&&(webApp.IsIPCIntel||webApp.IsSDIntel)&&b&&(-1!==a.inArray("HeatMap",b.SupportedRules)||-1!==a.inArray("HeatMap",b.SupportedScene)||-1!==a.inArray("HeatMapPlan",b.SupportedScene))})},{filename:"ipcIntellentCarConfig",t:"w_carDetection",authority:"IntelliConf",condition:a.when(j.get("IVSCaps"),j.is("DSPConflict")).then(function(b,c){return!c&&webApp.IsIPCIntel&&b&&-1!==a.inArray("ParkingDetection",b.SupportedRules)&&webCaps.is_new_IVSUI!==!0})},{filename:"ipcIntellTrafficConfig",t:"TrafficJunction",authority:"IntelliConf",condition:j.get("IVSCaps").then(function(b){return webApp.IsIPCIntel&&b&&-1!==a.inArray("Traffic",b.SupportedScene)})},{filename:"alarmConfig",t:"w_AlarmConf",authority:"Alarm",condition:!!webApp.ALARM_IN_NUMBER},{filename:"abnormalConfig",t:"w_ABNORMITY",authority:"AlarmConf"}]},{category:"temper",t:"w_temperConfig",condition:-1!==webApp.DeviceType.indexOf("TPC"),member:[{filename:"temperConfig",t:"w_ruleSet",authority:"TemperatureConfig"},{filename:"globalConfig",t:"w_globalConfig",authority:"TemperatureConfig"},{filename:"heatmapConfig",t:"heatMap",authority:"TemperatureConfig"}]},{category:"storage",t:"w_Memory Manage",member:[{filename:"recordPlanConfig",t:"w_Timetable",authority:"RecordConf"},{filename:"recordStorageConfig",t:"w_memory",authority:"RecordConf"},{filename:"recordCtrlConfig",t:"w_Recording Control",authority:"Record"},{filename:"cloudStorageConfig",t:"w_cloudStorage",authority:"Record"}]},{category:"system",t:"w_Sysmanager",member:[{filename:"generalConfig",t:"w_Local Config",authority:"GeneralConf"},{filename:"userManageConfig",t:"w_User Management",authority:"Account"},{filename:"wiperConfig",t:"w_OutdeviceManage",authority:"RainBrushConfig",condition:j.get("RainBrushControl").then(function(a){return a&&a.Support})},{filename:"ptzConfig",t:"w_PtzConfig_auth",authority:"PtzConfig",condition:a.when(j.get("HasPtz"),j.get("PtzFunctionMenu")).then(function(a,b){return a&&!(b&&b.Support)&&!isEnable("is_8M_Flash")&&-1===webApp.DeviceType.indexOf("SD_CA_ICT")&&-1===webApp.DeviceType.indexOf("IPC-HDB3200C")})},{filename:"commConfig",t:"w_ComConf_auth",authority:"ComConf",condition:!!isEnable("show_comm_config")},{filename:"defaultConfig",t:"w_Default Setting",authority:"DefaultConfig"},{filename:"backupConfig",t:"w_Collocate I/O",authority:"DefaultConfig"},{filename:"remoteConfig",t:"w_remote",authority:"Alarm",condition:j.get("WirelessAlarm").then(function(a){return a&&a.Support})},{filename:"autoMaintainConfig",t:"w_AutoMaintain_auth",authority:"AutoMaintain"},{filename:"upgradeConfig",t:"w_Firmware Upgrade",authority:"SysUpdate",condition:!isDDNS()}]},{category:"info",t:"w_System Info",member:[{filename:"versionConfig",t:"w_Edition Info"},{filename:"logManageConfig",t:"w_Log",condition:l.chkAuthority("QueryLog")||l.chkAuthority("DelLog")},{filename:"onlineUserConfig",t:"w_Onlineuser",authority:"Account"},{filename:"stateConfig",t:"lifeCounting",authority:"MPTZ",condition:j.get("PtzOperationStatus").then(function(a){return a&&a.Support})}]},{category:"advanced",t:"correctSet",condition:-1!==webApp.DeviceType.indexOf("TPC"),member:[{filename:"tempCorrectConfig",t:"machineSet"},{filename:"calibrationConfig",t:"FusionCalibrate"},{filename:"picmodeConfig",t:"picMode"},{filename:"temperModeConfig",t:"tmodMode"}]}]}var i=require("jsCore/rpc"),j=require("jsCore/ability"),k=require("common/common").Cookie,l=(require("jsCore/plugin"),require("jsCore/rpcLogin")),m=require("jsCore/pageBase");advanceSet=require("advanceShow");{var n="set-menu-current",o="set-item-current",p=null,q=webCaps.WebVersion?"?version="+webCaps.WebVersion:"",r=["GENETEC","YXSHOW","PSIA","YXISHOW","HSWX","LechangePro","None"];c.exports=m.extend({init:function(){var b=this,c=g(h());p=b,b.menuElem=b.$("#set-menu"),b.menuCont=b.$("#set-content");var k=a.grep(webApp.VSPs,function(b){return-1===a.inArray(b,r)});a.each(c,function(b,c){return"network"===c.category?(a.each(k,function(a,b){c.member.push({filename:b,t:b,vsp:"vsp"})}),!1):void 0});var l=a.template(b.$("#menu").html(),{data:c});b.menuElem.html(l).translation(),b.menuElem.find(".set-menu").on("click",d),b.menuElem.find(".set-item").on("click",e),f(c),j.get("AudioFileManager").done(function(a){webApp.IsAudioFileManager=!(!a||!a.Support)}),window.analyseSenceRuleMap={},i.ConfigManager.getConfig("VideoAnalyseGlobal").done(function(b){webCaps.is_new_IVSUI===!0?(analyseSenceRuleMap.Normal=0,analyseSenceRuleMap.FaceDetection=0,analyseSenceRuleMap.NumberStat=0):a.isArray(b)&&a.each(b,function(a,b){window.analyseSenceRuleMap[b.Scene.Type]=a})}),j.get("CifPFrameSize").done(function(a){a&&(cifPFrameMin=a[0],cifPFrameMax=a[1])})},render:function(){p.menuElem.find("."+o).click()},leave:function(){var b=p.menuElem.find(".set-item."+o),c=b.data("page");c&&a.isFunction(c.leave)&&c.leave()},destory:function(){var b=this;b.menuElem.find(".set-item").each(function(b,c){var d=a(c).data("page");d&&(a.isFunction(d.destory)&&d.destory(),a(c).data("page",null))}),b.menuElem.empty(),b.menuCont.empty(),p=null}})}})}(jQuery);var g_videoInConflict=function(){rpc.DevVideoOutput.getCollect(0).done(function(b){b&&webApp.IsIPCIntel&&rpc.DevVideoInput.getCapsEx(0,"VideoInConflict").done(function(b){if(b){var c=b.VideoInConflict||{};c.IsConflict&&c.ConflictTable.each(function(b){if(b.contains("DSP")){var c=a.DSP;c.conflictTable=c.conflictTable.concat(b.filter(function(a){return"DSP"!=a}))}if(b.contains("TVOut")){var d=a.TVOut;d.conflictTable=d.conflictTable.concat(b.filter(function(a){return"TVOut"!=a}))}})}})});var a={TVOut:{conflictTable:[],hasConflict:function(){var b=this;return jQuery.Deferred(function(c){var d=0,e=b.conflictTable;e.length?e.each(function(e){a[e]&&a[e].isEnable&&a[e].isEnable().then(function(){c.resolve()},function(){d++,d==b.conflictTable.length&&c.reject()})}):c.reject()}).promise()},isEnable:function(){return jQuery.Deferred(function(a){rpc.ConfigManager.getConfig("VideoOut").done(function(b){if(b){var c=b.some(function(a){return a.Enable});c?a.resolve():a.reject()}else a.reject()}).fail(function(){a.reject()})}).promise()},disableConflicts:function(){var b=[];return this.conflictTable.each(function(c){b.push(a[c].disable())}),Promise.all(b)},disable:function(){return jQuery.Deferred(function(a){rpc.ConfigManager.getConfig("VideoOut").done(function(b){b?(b.each(function(a){a.Enable=!1}),rpc.ConfigManager.setConfig("VideoOut",b).done(function(){a.resolve()})):a.resolve("GetVideoOutError")}).fail(function(){a.resolve("GetVideoOutError")})}).promise()}},DSP:{conflictTable:[],hasConflict:function(){var b=this;return jQuery.Deferred(function(c){var d=0,e=b.conflictTable;e.length?e.each(function(e){a[e]&&a[e].isEnable&&a[e].isEnable().then(function(){c.resolve()},function(){d++,d==b.conflictTable.length&&c.reject()})}):c.reject()}).promise()},isEnable:function(){return jQuery.Deferred(function(a){rpc.ConfigManager.getConfig("VideoAnalyseRule").done(function(b){if(b){var c=b.some(function(a){return a.some(function(a){return a.Enable})});c?a.resolve():a.reject()}else a.reject()}).fail(function(){a.reject()})}).promise()},disableConflicts:function(){var b=[];return this.conflictTable.each(function(c){b.push(a[c].disable())}),Promise.all(b)},disable:function(){return jQuery.Deferred(function(a){rpc.ConfigManager.getConfig("VideoAnalyseRule").done(function(b){b?(b.each(function(a){a.each(function(a){a.Enable=!1})}),rpc.ConfigManager.setConfig("VideoAnalyseRule",b).done(function(){a.resolve()})):a.resolve("GetVideoAnalyseRuleError")}).fail(function(){a.resolve("GetVideoAnalyseRuleError")})}).promise()}}};return a}();define("advanceShow",function(require,a,b){function c(){jQuery(document.body).append('<div id="correct_pwdBox" class="ui-dialog" style=" width:300px; display:none; z-index:10001;left:650px; top:156px;">            <div class="ui-dialog-title">                <h1 t="correctSet">Default</h1>                <a class="ui-dialog-icon" id="correct_close"></a>            </div>            <div class="ui-dialog-content fn-pad10">                <form>                    <div class="ui-form-item">                        <label class="ui-label fn-width60 fn-textright fn-marr10" t="w_password">password</label>                        <input type="password" class="ui-input" id="correct_pwd" maxlength="64"/>                    </div>                </form>            </div>            <div class="ui-button-box">                <a class="ui-button" id="correct_pwdConfirm" t="w_Confirm">Save</a>                <a class="ui-button" id="correct_pwdCancel" t="Cancel">Cancel</a>            </div>            <div class="ui-tip fn-padl10">                <div class="ui-tip-container" id="correct_remark" style="display:none; min-width:260px;">                    <span class="ui-tip-icon"></span>                    <label id="correct_remark_label">Saved successfully!</label>                </div>            </div>        </div>'),$("correct_pwdBox").translation()}function d(){if("dh_thermal"==$("correct_pwd").value){$("correct_pwdBox").setStyle("display","none"),$("markframe").setStyle("display","none");var a=i.getFirst("a");a.addClass("set-menu-current").getNext("ul").setStyle("display","block"),a.getNext("ul").getChildren("li")[0].getChildren("a").fireEvent("click"),g=!0}else remarkDisplay("correct_remark",tl("w_passwordError"),3e3,1)}function e(){$("correct_pwdBox").setStyle("display","none"),$("markframe").setStyle("display","none")}function f(a){if(Browser.ie)document.documentElement.releaseCapture();else{var a=a?a:event;a.preventDefault()}}var g=!1,h=!0,i=null;b.exports={init:function(){i=$$("li[category=advanced]")[0],h=!!i,h&&(i.style.display="none",c(),this.bind())},bind:function(){$(document.body).addEvent("keydown",function(a){var b=$$("div[data-page=set]")[0].hasClass("current");(a.control&&"u"==a.key||a.control&&a.alt&&"u"==a.key)&&f(a),!a.alt&&a.control&&"u"==a.key&&b?i.style.display="":a.control&&a.alt&&"u"==a.key&&b&&(i.style.display="none")}),$("correct_pwdConfirm").addEvent("click",d),$$("#correct_pwdCancel,#correct_close").addEvent("click",e),$("correct_pwd").addEvent("keydown",function(a){"enter"==a.key&&(f(a),$("correct_pwdConfirm").fireEvent("click"))})},checkAdvAuth:function(a){var b="advanced"==a.getParent("li").getProperty("category");return b?(g||($("correct_pwd").value="",Browser.ie7||$("markframe").setStyle("display","block"),$("correct_pwdBox").setStyle("display","block"),$("correct_pwd").focus()),g):!0}}});