!function(a){define(function(require,b,c){c.exports=require("jsCore/pageTab");var d=require("jsCore/ability"),e=require("jsCore/rpcLogin");c.exports.prototype.getCondition=function(){c.exports.prototype.camera_focus=a.when(d.get("VideoInputCapsEx"),d.get("VideoInputCaps")).then(function(b,c){return setTimeout(function(){var d=a("[data-for=camera_focus][t=w_zoomFocus]"),e="w_zoomFocus";b&&b.ABFFunction.Support?e="W_focus":c&&c.SyncFocus&&(e="W_zoom"),d.attr("t",e).parent().translation()},0),(b&&b.ABFFunction.Support||c&&(c.ElectricFocus||c.SyncFocus))&&e.chkAuthority("VideoInputConfig")&&e.chkAuthority("Monitor_01")})},c.exports.prototype.camera_steady=d.get("SteadyLightControl").then(function(a){return!(!a||!a.Support)}),c.exports.prototype.camera_flick=d.get("VideoInputCapsEx").then(function(a){return!!(a&&a.Flicker&&a.Flicker.Support)}),c.exports.prototype.camera_matrixSwitch=d.get("CSCMatrixSwitch").then(function(a){return!(!a||!a.RGBTOYUV)})}),define("camera_attr",function(require,b,c){function d(){var a=g(p).keys;return a.push("VideoInMode"),j.ConfigManager.restoreTemporaryConfig(a)}function e(a,b,c){var d=b.split(".");return"VideoImageControl"===a?1===d.length?p[a][q][b]=c:2===d.length?p[a][q][d[0]][d[1]]=c:3===d.length&&(p[a][q][d[0]][d[1]][d[2]]=c):1===d.length?p[a][q][r][b]=c:2===d.length?p[a][q][r][d[0]][d[1]]=c:3===d.length&&(p[a][q][r][d[0]][d[1]][d[2]]=c),j.ConfigManager.setTemporaryConfig(a,p[a])}function f(a,b){var c=b.split(".");if("VideoImageControl"===a){if(1===c.length)return p[a][q][b];if(2===c.length)return p[a][q][c[0]][c[1]];if(3===c.length)return p[a][q][c[0]][c[1]][c[2]]}else{if(1===c.length)return p[a][q][r][b];if(2===c.length)return p[a][q][r][c[0]][c[1]];if(3===c.length)return p[a][q][r][c[0]][c[1]][c[2]]}}function g(b){var c={keys:[],values:[]};return a.isPlainObject(b)?(a.each(b,function(a,d){b.hasOwnProperty(a)&&(c.keys.push(a),c.values.push(d))}),c):c}function h(a){if(!p.VideoImageControl||!p.VideoImageControl[q])return a;var b=[],c=[],d=f("VideoImageControl","Flip"),e=f("VideoImageControl","Rotate90"),g=f("VideoImageControl","Mirror");if(1===e?(b[0]=a[1],b[1]=8191-a[0],b[2]=a[3],b[3]=8191-a[2]):2===e?(b[0]=8191-a[1],b[1]=a[0],b[2]=8191-a[3],b[3]=a[2]):d?(b[0]=a[0],b[1]=8191-a[1],b[2]=a[2],b[3]=8191-a[3]):(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]),b[0]>b[2]){var h=b[0];b[0]=b[2],b[2]=h}if(b[1]>b[3]){var i=b[1];b[1]=b[3],b[3]=i}return g?(c[0]=8191-b[2],c[1]=b[1],c[2]=8191-b[0],c[3]=b[3],c):b}function i(a){if(!p.VideoImageControl||!p.VideoImageControl[q])return a;var b=[],c=[],d=f("VideoImageControl","Flip"),e=f("VideoImageControl","Rotate90"),g=f("VideoImageControl","Mirror");if(1===e?(b[0]=8191-a[1],b[1]=a[0],b[2]=8191-a[3],b[3]=a[2]):2===e?(b[0]=a[1],b[1]=8191-a[0],b[2]=a[3],b[3]=8191-a[2]):d?(b[0]=a[0],b[1]=8191-a[1],b[2]=a[2],b[3]=8191-a[3]):(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]),b[0]>b[2]){var h=b[0];b[0]=b[2],b[2]=h}if(b[1]>b[3]){var i=b[1];b[1]=b[3],b[3]=i}return g?(0===e?(c[0]=8191-b[2],c[1]=b[1],c[2]=8191-b[0],c[3]=b[3]):(c[0]=b[0],c[1]=8191-b[3],c[2]=b[2],c[3]=8191-b[1]),c):b}var j=require("jsCore/rpc"),k=require("jsCore/pageBase"),l=require("jsCore/plugin"),m=require("jsCore/ability");common=require("common/common"),require("widget/js/dui.slider"),require("jsCore/modules/minPtzControl");var n,o=null,p={},q=0,r=0,s=null,t=null,u=null;c.exports=k.extend({init:function(){o=this,l.CheckFuncSupport(2).done(function(b){b?a("#c_a_fullscreen").show():a("#c_a_fullscreen").hide()}),a.when(m.get("VideoInputCapsEx"),m.is("LDC")).done(function(a,b){t=a,o._initPtz(),o._initTab(b),o.render()})},_initPtz:function(){-1!==webApp.DeviceType.indexOf("SD")?(u=o.$("#attr_mptz").minPtzControl(),u.minPtzControl("init",{showBoat:!0,showStep:!0})):webApp.CHANNEL_NUMBER>1},_initTab:function(b){var c=o.$(".u-tab"),d=o.$(".u-tab-content");c.find("[data-for=attr_LightGlobal]").hide(),m.get("LightGlobal").done(function(a){a&&a.Support&&c.find("[data-for=attr_LightGlobal]").show()}),t&&t.VideoInWhiteBalance&&t.VideoInWhiteBalance.Support||(c.find("[data-for=attr_whitebalance]").remove(),d.find("[data-page=attr_whitebalance]").remove()),t&&t.VideoInDefog&&t.VideoInDefog.Support||(c.find("[data-for=attr_defog]").remove(),d.find("[data-page=attr_defog]").remove()),b?c.find("[data-for=attr_ldc]").show():(c.find("[data-for=attr_ldc]").remove(),d.find("[data-page=attr_ldc]").remove()),t&&t.VideoInDayNight&&t.VideoInDayNight.Support||(c.find("[data-for=attr_daynight]").remove(),d.find("[data-page=attr_daynight]").remove());var e=t&&t.VideoInZoom&&t.VideoInZoom.Support;e=e||t.VideoInFocus&&t.VideoInFocus.Support,e||(c.find("[data-for=attr_zoomfocus]").remove(),d.find("[data-page=attr_zoomfocus]").remove()),t&&t.LightingControl&&t.LightingControl.Support||(c.find("[data-for=attr_light]").remove(),d.find("[data-page=attr_light]").remove()),t&&t.VideoInBacklight&&t.VideoInBacklight.Support||(c.find("[data-for=attr_backlight]").remove(),d.find("[data-page=attr_backlight]").remove());var f=t&&t.VideoInColor&&t.VideoInColor.Support;f=f||t.VideoImageControl&&t.VideoImageControl.Support,f=f||t.VideoInSharpness&&t.VideoInSharpness.Support,f||(c.find("[data-for=attr_picture]").remove(),d.find("[data-page=attr_picture]").remove());var g=t&&t.VideoInExposure&&t.VideoInExposure.Support;g=g||t.VideoInDenoise&&t.VideoInDenoise.Support,g||(c.find("[data-for=attr_exposure]").remove(),d.find("[data-page=attr_exposure]").remove()),c.children("li[data-for]").each(function(b,c){var e=o.$(c),f=e.attr("data-for");require.async(f,function(a){e.data("tabInstance",new a({element:d.find("[data-page="+f+"]")}))});var g=e.attr("cfg");g&&(g=g.split(","),a.each(g,function(a,b){p[b]=null}))}),c.tab({switched:function(a,b){b.from&&(c.children("li[data-for="+b.from+"]").data("tabInstance").leave(),c.children("li[data-for="+b.to+"]").data("tabInstance").render())}})},render:function(){l.cover("#attr_video",function(){l.SetRegionNum(0),l.SetModuleMode(1),webApp.DeviceType.contains("TPC")?(l.SetVisibleVideoWnd(1,0),login.chkAuthority("Monitor_01")&&l.open(l.stream,0,1),!login.chkAuthority("Monitor_01")&&l.SetVideoWndTip(0,tl("noVideoAuthoity"))):l.open()}),o._getConfig(!1)},_render:function(){0===s[q].Mode?o.$("[sel-for=onSelectConfig]").val(s[q].Config[0]).change():j.Global.getCurrentTime().done(function(a){var b=parsrTimeEx(s[q].TimeSection[0][0]),c=new Date(a.replace(/-/g,"/")),d=new Date(a.replace(/-/g,"/")),e=new Date(a.replace(/-/g,"/"));d.setHours(b[1],b[2],b[3]),e.setHours(b[4],b[5],b[6]);var f;f=c>d&&e>c?0:1,o.$("[sel-for=onSelectConfig]").val(f).change()})},leave:function(){l.hide(),d();var a=o.$(".u-tab").children("li.current").data("tabInstance");a&&a.leave()},destory:function(){d(),o.$(".u-tab").children().each(function(a,b){o.$(b).data("tabInstance").destory()})},onDefault:function(){return j.ConfigManager.restoreTemporaryConfig("VideoInMode"),j.ConfigManager.getConfig("VideoInMode").done(function(b){s=b;var c=g(p).keys;j.ConfigManager.getDefault(c).done(function(b){a.each(b,function(a,b){b.result&&(p[c[a]]=b.params.table)}),o._render(),j.ConfigManager.setTemporaryConfig(c,g(p).values),o.$("#attr_tip").tip("success",tl("Defaultsuccess"))}).fail(function(){o.$("#attr_tip").tip("error",tl("Defaultfailure"))})}),j.ConfigManager.getDefault("LightGlobal").done(function(a){n=a,n[0].Enable=!0,o.$("[sel-for=attr_LightGlobal_mode]").val(0)}),!1},onRefresh:function(){return d().done(function(){o._getConfig(!0)}),!1},onSave:function(){var a=g(p);return j.ConfigManager.setConfig(a.keys,a.values).done(function(a){if(common.chkMutilCallRet(a))o.$("#attr_tip").tip("success",tl("Succeed in saving configure"));else{var b="Saving failure";o.$("#attr_pic_flip").data("notSupport")&&(b="w_can not Filp"),o.$("#attr_tip").tip("error",tl(b))}}).fail(function(){o.$("#attr_tip").tip("error",tl("Saving failure"))}),j.ConfigManager.getConfig("LightGlobal").done(function(a){n=a,n[0].Enable=1==o.$("[sel-for=attr_LightGlobal_mode]").val()?!1:!0,j.ConfigManager.setConfig("LightGlobal",n).done(function(){})}),!1},onFullScreen:function(){return l.SetFullScreen(),!1},onSelectConfig:function(a){return r=o.$(a.target).val()-0,a.isTrigger?o.$(".u-tab").children("li.current").data("tabInstance").render():j.ConfigManager.setTemporaryConfig("VideoInMode",[{Mode:0,Config:[r],TimeSection:s[q].TimeSection}]).done(function(){o.$(".u-tab").children("li.current").data("tabInstance").render()}),!1},_getConfig:function(b){j.ConfigManager.getConfig("VideoInMode").done(function(c){s=c;var d=g(p).keys;j.ConfigManager.getConfig(d).done(function(b){a.each(b,function(a,b){b.result&&(p[d[a]]=b.params.table)})}).done(function(){o._render(),b&&o.$("#attr_tip").tip("success",tl("Operateingsuccess"))}).fail(function(){o.$("#attr_tip").tip("error",tl("Operateingfailure"))})})}}),define("attr_picture",function(require,b,c){var d=null,g={Standard:"w_Standard",Gentle:"w_Gentle",Flamboyant:"w_Flamboyant"};c.exports=k.extend({init:function(){d=this,d._initSelect(),d._initSlider(),d._initInput()},_initSelect:function(){var b=d.$("#attr_pic_style").empty();t.VideoInColor&&t.VideoInColor.Style&&t.VideoInColor.Style.Support?(a.each(t.VideoInColor.Style.SupportList,function(a,c){b.append("<option value="+c+" t="+g[c]+"></option>")}),b.translation().change(function(a){return e("VideoColor","Style",d.$(a.target).val()),!1})):b.parent().remove();var c=d.$("#attr_pic_flip").empty();m.is("RotateConflict").done(function(a){t.VideoImageControl&&(t.VideoImageControl.Flip||t.VideoImageControl.Rotate90)?(t.VideoImageControl.Flip&&t.VideoImageControl.Rotate90?(c.append('<option value="0" t=w_noFlipEx></option>'),!a&&c.append('<option value="1" t=w_clockwise90Ex></option>'),c.append('<option value="3" t=w_Flip180Ex></option>'),!a&&c.append('<option value="2" t=w_clockwise90Ex2></option>')):t.VideoImageControl.Flip?(c.append('<option value="0" t=w_noFlipEx></option>'),c.append('<option value="3" t=w_Flip180Ex></option>')):(c.append('<option value="0" t=w_noFlipEx></option>'),!a&&c.append('<option value="1" t=w_clockwise90Ex></option>'),!a&&c.append('<option value="2" t=w_clockwise90Ex2></option>')),c.translation().change(function(a){var b,f,g=d.$(a.target),h=g.val();return"0"===h?(b=!1,f=0):"1"===h?(b=!1,f=1):"3"===h?(b=!0,f=0):"2"===h&&(b=!1,f=2),p.VideoImageControl[q].Flip=b,c.data("notSupport",!1),e("VideoImageControl","Rotate90",f).fail(function(){f&&c.data("notSupport",!0)}),!1})):c.parent().remove()})},_initSlider:function(){t.VideoInColor&&t.VideoInColor.Brightness||d.$("[slider][key=Brightness]").parent().remove(),t.VideoInColor&&t.VideoInColor.Contrast||d.$("[slider][key=Contrast]").parent().remove(),t.VideoInColor&&t.VideoInColor.Saturation||d.$("[slider][key=Saturation]").parent().remove(),t.VideoInColor&&t.VideoInColor.ChromaSuppress||d.$("[slider][key=ChromaSuppress]").parent().remove(),t.VideoInColor&&t.VideoInColor.Gamma||d.$("[slider][key=Gamma]").parent().remove(),t.VideoInSharpness&&t.VideoInSharpness.Support||d.$("[slider][key=Sharpness]").parent().remove(),t.VideoInSharpness&&t.VideoInSharpness.Restrain&&t.VideoInSharpness.Restrain.Support||d.$("[slider][key=Level]").parent().remove(),d.$("[slider][key]").slider({min:0,max:100,complete:function(a,b){var c=d.$(a.target),f=c.attr("cfg"),g=c.attr("key");e(f,g,b.value)}})},_initInput:function(){t.VideoImageControl&&t.VideoImageControl.Mirror||d.$("#attr_pic_mirror_wrap").remove(),t.VideoImageControl&&t.VideoImageControl.Freeze||d.$("#attr_pic_imageFre_wrap").remove(),t.VideoImageControl&&t.VideoImageControl.Stable||d.$("#attr_pic_imageSta_wrap").remove(),d.$("input[name^=attr_pic_]").click(function(a){var b=d.$(a.target),c=!b.is("[off]");"attr_pic_imageSta"===b.attr("name")&&(4&t.VideoImageControl.Stable&&l.ControlVideoStable(c),c=c?t.VideoImageControl.Stable:0),e(b.attr("cfg"),b.attr("key"),c)})},render:function(){d.$("[slider][cfg][key]").each(function(a,b){var c=d.$(b),e=c.attr("cfg"),g=c.attr("key");c.slider("value",f(e,g))}),d.$("#attr_pic_flip,#attr_pic_style").each(function(a,b){var c=d.$(b),e=c.attr("cfg"),g=c.attr("key");if(g)c.val(f(e,g));else{var h=0,i=f(e,"Flip"),j=f(e,"Rotate90");0==i&&0==j?h=0:0==i&&1==j?h=1:1==i&&0==j?h=3:0==i&&2==j&&(h=2),c.val(h)}}),d.$("[name^=attr_pic_]").each(function(a,b){var c=d.$(b),e=f(c.attr("cfg"),c.attr("key"));"attr_pic_imageSta"===c.attr("name")&&(e=!!e,4&t.VideoImageControl.Stable&&l.ControlVideoStable(e)),c.prop("checked",e!==c.is("[Off]"))})}})}),define("attr_exposure",function(require,b,c){function d(a){return(1e3/a).toFixed(2)-0}var g=null,h={Outdoor:0,"50Hz":1,"60Hz":2},i={0:"Outdoor",1:"50Hz",2:"60Hz"},j={Outdoor:"w_outdoor","50Hz":"50Hz","60Hz":"60Hz"},l={Auto:0,Manual:4,Shutter:8,Iris:5,Gain:7,ManualFixed:6},m={0:"Auto",4:"Manual",8:"Shutter",5:"Iris",7:"Gain",6:"ManualFixed"},n={Auto:"w_Automatic",Manual:"w_Manual",Shutter:"w_ShutterFirst",Iris:"w_IrisFirst",Gain:"w_Gainfirst",ManualFixed:"Manual"},o=null;c.exports=k.extend({init:function(){g=this,o=t.VideoInExposure&&t.VideoInExposure.Speed?t.VideoInExposure.Speed:{Manual:[1e5,3e4,1e4,4e3,2e3,1e3,500,250,120,100,60,50,30,25,15,12,10,8,6,5,4,3,-1],Manual50Hz:[100,50,25,10,5,4],Manual60Hz:[120,60,30,12,6,4],ShutterPAL:[1e5,3e4,1e4,4e3,2e3,500,250,100,50,25,-1],ShutterNTSC:[1e5,3e4,1e4,4e3,2e3,500,250,120,60,30,-1]},webApp.GongAnDetect&&o.Manual.splice(-1,0,1),g._initSelect(),g._initInput(),g._initSlider()},_initSelect:function(){var b=g.$("[sel-for=onSelSS]").empty(),c="PAL"===webApp.VideoStandard?"Pal":"Ntsc";t.VideoInExposure.SlowSpeed&&t.VideoInExposure.SlowSpeed[c]?a.each(t.VideoInExposure.SlowSpeed[c],function(a,c){b.append("<option value="+c+">1/"+c+"</option>")}):b.parent().remove(),t.VideoInExposure&&t.VideoInExposure.RecoveryTime||g.$("[sel-for=onSelRT]").parent().remove()},onSelSS:function(a){return e("VideoInExposure","SlowSpeed",g.$(a.target).val()-0),!1},onSelRT:function(a){return e("VideoInExposure","RecoveryTime",g.$(a.target).val()-0),!1},onSelFlicker:function(b){var c=g.$(b.target).val();g.$(b.target).data("isTrigger",!!b.isTrigger),p.VideoInExposure[q][r].AntiFlicker=h[c];var d=a.grep(t.VideoInExposure.Modes,function(a){var b=t.VideoInBacklight&&2===t.VideoInBacklight.WideDynamicRange;return b=b&&"WideDynamic"===f("VideoInBacklight","Mode"),"Outdoor"!==c||b?"Manual"===a||"Auto"===a||"ManualFixed"===a:a}),e=g.$("[sel-for=onSelMode]").empty(),i=m[f("VideoInExposure","Mode")];return a.each(d,function(a,b){e.append("<option value="+b+" t="+n[b]+"></option>")}),e.translation(),-1!==a.inArray(i,d)&&e.val(i),e.change(),!1},onSelMode:function(b){function c(b){a.each(b,function(a,b){u.append(-1===b?'<option value="Custom" t="w_CostomDifsec"></option>':"<option value="+d(b)+">1/"+b+"</option>")}),u.translation().parent().show();var c=g.$("[sel-for=onSelFlicker]").data("isTrigger"),e=g.$("[sel-for=onSelMode]").val();"boolean"!==a.type(c)||c||"Manual"!=e?v===w&&u.is(":has(option[value="+v+"])")?u.val(v).change():u.is(":has(option[value=Custom])")?u.val("Custom").change():u.change():a.inArray("10",b)&&"50Hz"===x?u.val(10).change():a.inArray("8.33",b)&&"60Hz"===x?u.val(8.33).change():a.inArray("40",b)&&"Outdoor"===x&&"PAL"===webApp.VideoStandard?u.val(40).change():a.inArray("33.33",b)&&"Outdoor"===x&&"PAL"!==webApp.VideoStandard?u.val(33.33).change():u.change()}var h=g.$(b.target).val();"ManualFixed"===h||"Manual"===h?(g.$("[slider][key=Compensation]").parent().hide(),g.$("[slider][key=SlowAutoExposure]").parent().hide()):(g.$("[slider][key=Compensation]").parent().show(),g.$("[slider][key=SlowAutoExposure]").parent().show());var j=g.$("#attr_ex_minIris"),k=g.$("#attr_ex_maxIris"),m=g.$("[slider][key=Iris]");"ManualFixed"===h||"Manual"===h||"Iris"===h?t.VideoInExposure&&t.VideoInExposure.SupportIrisRange?(m.parent().hide(),k.numberfield("value",f("VideoInExposure","IrisMax")),j.numberfield("value",f("VideoInExposure","IrisMin")).parent().show()):(m.parent().show(),k.parent().hide()):(m.parent().hide(),k.parent().hide());var n=g.$("#attr_ex_minGain"),s=g.$("#attr_ex_maxGain");"Manual"===h||"Gain"===h?(s.numberfield("value",f("VideoInExposure","GainMax")),n.numberfield("value",f("VideoInExposure","GainMin")).parent().show()):n.parent().hide(),"ManualFixed"===h?g.$("[slider][key=Gain]").parent().show():g.$("[slider][key=Gain]").parent().hide(),"Iris"===h||"Auto"===h||"Shutter"===h?(g.$("[slider][key=GainMax]").slider("value",f("VideoInExposure","GainMax")).parent().show(),p.VideoInExposure[q][r].GainMin=0):g.$("[slider][key=GainMax]").parent().hide();var u=g.$("[sel-for=onSelShutter]").empty(),v=f("VideoInExposure","Value1"),w=f("VideoInExposure","Value2");if("Manual"===h||"ManualFixed"===h||"Shutter"===h)if(p.VideoInExposure[q][r].Mode=l[h],g.$("#attr_ex_ss_wrap").hide(),g.$("[sel-for=onSelSS]").parent().hide(),"Manual"===h||"ManualFixed"===h){var x=i[f("VideoInExposure","AntiFlicker")];if("Outdoor"===x){var y=t.VideoInBacklight&&2===t.VideoInBacklight.WideDynamicRange;y=y&&"WideDynamic"===f("VideoInBacklight","Mode");var z=a.grep(o.Manual,function(a){return y&&-1!==a?"PAL"===webApp.VideoStandard?a>=25:a>=30:!0});c(z)}else c("50Hz"===x?o.Manual50Hz:o.Manual60Hz)}else c("PAL"===webApp.VideoStandard?o.ShutterPAL:o.ShutterNTSC);else u.parent().hide(),g.$("#attr_ex_minShutter").parent().hide(),g.$("#attr_ex_ss_wrap").show(),g.$("[sel-for=onSelSS]").parent().show(),e("VideoInExposure","Mode",l[h]);return!1},onSelShutter:function(a){var b=g.$(a.target),c=b.val();if("Custom"===c){var d=b.children(":last").prev().val()-0,h=g.$("#attr_ex_minShutter").numberfield("min",0).numberfield("max",d),i=g.$("#attr_ex_maxShutter").numberfield("min",0).numberfield("max",d);a.isTrigger?(h.numberfield("value",f("VideoInExposure","Value1")).parent().show(),i.numberfield("value",f("VideoInExposure","Value2")),e("VideoInExposure","Value1",f("VideoInExposure","Value1"))):(h.numberfield("value",0).parent().show(),i.numberfield("value",f("VideoInExposure","Value2")),e("VideoInExposure","Value1",0)),g.$("#attr_ex_maxShutterTip").text(d)}else g.$("#attr_ex_minShutter").parent().hide(),p.VideoInExposure[q][r].Value1=c-0,e("VideoInExposure","Value2",c-0);return!1},_initInput:function(){g.$("#attr_ex_minShutter,#attr_ex_maxShutter").numberfield({allowNegative:!1,decimalPrecision:5,error:function(a,b){"range"===b.type&&("attr_ex_minShutter"===b.ui.element.attr("id")?p.VideoInExposure[q][r].Value1=b.ui.value():p.VideoInExposure[q][r].Value2=b.ui.value())}}).blur(function(){var a=g.$("#attr_ex_minShutter").numberfield("value"),b=g.$("#attr_ex_maxShutter").numberfield("value");a>b&&g.$("#attr_ex_maxShutter").numberfield("value",b=a),p.VideoInExposure[q][r].Value1=a,e("VideoInExposure","Value2",b)}),g.$("#attr_ex_minIris,#attr_ex_maxIris").numberfield({min:0,max:100,allowNegative:!1,allowDecimal:!1}).blur(function(){var a=g.$("#attr_ex_minIris").numberfield("value"),b=g.$("#attr_ex_maxIris").numberfield("value");a>b&&g.$("#attr_ex_maxIris").numberfield("value",b=a),p.VideoInExposure[q][r].IrisMin=a,e("VideoInExposure","IrisMax",b)}),g.$("#attr_ex_minGain,#attr_ex_maxGain").numberfield({allowNegative:!1,allowDecimal:!1,min:0,max:100}).blur(function(){var a=g.$("#attr_ex_minGain").numberfield("value"),b=g.$("#attr_ex_maxGain").numberfield("value");a>b&&g.$("#attr_ex_maxGain").numberfield("value",b=a),p.VideoInExposure[q][r].GainMin=a,e("VideoInExposure","GainMax",b)}),t.VideoInExposure&&t.VideoInExposure.SlowShutter||g.$("#attr_ex_ss_wrap").remove(),t.VideoInIRExposure&&t.VideoInIRExposure.Support||g.$("#attr_ex_IR_wrap").remove(),t.VideoInExposure&&t.VideoInExposure.IrisAuto||g.$("#attr_ex_IA_wrap").remove(),g.$("[name=attr_ex_ss],[name=attr_ex_IR],[name=attr_ex_IA]").click(function(a){var b=g.$(a.target);a.isTrigger||e(b.attr("cfg"),b.attr("key"),!b.is("[off]"))}),t.VideoInDenoise&&t.VideoInDenoise["2D"]&&t.VideoInDenoise["2D"].Support?g.$("[name=attr_ex_2d]").click(function(a){var b=g.$(a.target),c=b.is("[off]");c?g.$("[slider][key=2DLevel]").parent().hide():g.$("[slider][key=2DLevel]").parent().show(),a.isTrigger||e(b.attr("cfg"),b.attr("key"),!c)}):g.$("#attr_ex_2d_wrap").remove(),t.VideoInDenoise&&t.VideoInDenoise["3D"]&&t.VideoInDenoise["3D"].Support?g.$("[name=attr_ex_3d]").click(function(a){var b=g.$(a.target),c=b.attr("mode");"Off"===c?g.$('[slider][key="3DAutoType.AutoLevel"]').parent().hide():g.$('[slider][key="3DAutoType.AutoLevel"]').parent().show(),a.isTrigger||e(b.attr("cfg"),b.attr("key"),c)}):g.$("#attr_ex_3d_wrap").remove(),t.VideoInDenoise&&t.VideoInDenoise.DenoiseAlgorithm1&&t.VideoInDenoise.DenoiseAlgorithm1.Support?g.$("[name=attr_ex_adv]").click(function(a){var b=g.$(a.target),c=b.attr("mode");"Off"===c?g.$("[slider][key^=DenoiseAlgorithm1]").parent().hide():g.$("[slider][key^=DenoiseAlgorithm1]").parent().show(),a.isTrigger||e(b.attr("cfg"),b.attr("key"),c)}):g.$("#attr_ex_adv_wrap").remove()},_initSlider:function(){t.VideoInExposure&&-1!==a.inArray("ManualFixed",t.VideoInExposure.Modes)||g.$("[slider][key=Gain]").parent().remove(),t.VideoInExposure&&t.VideoInExposure.SupportGainUpperLimit||g.$("[slider][key=GainMax]").parent().remove(),t.VideoInExposure&&-1!==a.inArray("Iris",t.VideoInExposure.Modes)||(g.$("[slider][key=Iris]").parent().remove(),g.$("#attr_ex_maxIris").parent().remove()),t.VideoInExposure&&t.VideoInExposure.Compensation||g.$("[slider][key=Compensation]").parent().remove(),t.VideoInExposure&&t.VideoInExposure.SlowAutoExposure||g.$("[slider][key=SlowAutoExposure]").parent().remove(),t.VideoInDenoise&&t.VideoInDenoise["2D"]&&t.VideoInDenoise["2D"].Support||g.$("[slider][key=2DLevel]").parent().remove(),t.VideoInDenoise&&t.VideoInDenoise["3D"]&&t.VideoInDenoise["3D"].Support||g.$('[slider][key="3DAutoType.AutoLevel"]').parent().remove(),t.VideoInDenoise&&t.VideoInDenoise.DenoiseAlgorithm1&&t.VideoInDenoise.DenoiseAlgorithm1.Support||g.$('[slider][key^="DenoiseAlgorithm1"]').parent().remove(),g.$("[slider][cfg][key]").slider({min:0,max:100,complete:function(a,b){var c=g.$(a.target),d=c.attr("cfg"),f=c.attr("key");e(d,f,b.value)}})},render:function(){var b=t.VideoInBacklight&&2===t.VideoInBacklight.WideDynamicRange;b=b&&"WideDynamic"===f("VideoInBacklight","Mode");var c=g.$("[sel-for=onSelFlicker]").empty();if(t.VideoInExposure.AntiFlicker&&t.VideoInExposure.AntiFlicker.Support){var d=a.grep(t.VideoInExposure.AntiFlicker.SupportList,function(a){return b?"Outdoor"===a:a}),e=i[f("VideoInExposure","AntiFlicker")];a.each(d,function(a,b){c.append("<option value="+b+" t="+j[b]+"></option>")}),c.translation(),c.is(":has(option[value="+e+"])")&&c.val(e),c.change()}else{c.parent().remove();var h=a.grep(t.VideoInExposure.Modes,function(a){return b?"Manual"===a||"Auto"===a||"ManualFixed"===a:a}),k=g.$("[sel-for=onSelMode]").empty(),e=m[f("VideoInExposure","Mode")];a.each(h,function(a,b){k.append("<option value="+b+" t="+n[b]+"></option>")}),k.translation(),k.is(":has(option[value="+e+"])")&&k.val(e),k.change()}g.$("[sel-for=onSelSS],[sel-for=onSelRT]").each(function(a,b){var c=g.$(b);c.val(f(c.attr("cfg"),c.attr("key")))}),g.$("[slider][cfg][key]").each(function(a,b){var c=g.$(b);c.slider("value",f(c.attr("cfg"),c.attr("key")))}),g.$('[key=3DType],[key="DenoiseAlgorithm1.Type"]').each(function(a,b){var c=g.$(b),d=c.attr("key");f(c.attr("cfg"),d)===c.attr("mode")&&c.click(),"3DType"===d?g.$('[slider][key="3DAutoType.AutoLevel"]').slider("value",f("VideoInDenoise","3DAutoType.AutoLevel")):(g.$('[key="DenoiseAlgorithm1.TnfLevel"]').slider("value",f("VideoInDenoise","DenoiseAlgorithm1.TnfLevel")),g.$('[key="DenoiseAlgorithm1.SnfLevel"]').slider("value",f("VideoInDenoise","DenoiseAlgorithm1.SnfLevel")))}),g.$("[key=2DEnable],[key=SlowShutter],[key=IrisAuto],[cfg=VideoInIRExposure][key=Enable]").each(function(a,b){var c=g.$(b),d=c.attr("key");f(c.attr("cfg"),d)!==c.is("[off]")&&c.click(),"2DEnable"===d&&g.$("[slider][key=2DLevel]").slider("value",f("VideoInDenoise","2DLevel"))})}})}),define("attr_backlight",function(require,b,c){var d=null,g={Off:"w_off",Backlight:"w_Backlight",GlareInhibition:"w_GlareInhibition",WideDynamic:"WideDynamicRange",SSA:"SSA"};c.exports=k.extend({init:function(){d=this,-1!==a.inArray("Region",t.VideoInBacklight.BacklightMode)?d.$("[name=attr_bl_region]").click(function(a){var b=d.$(a.target).attr("mode");d._showDrawArea("Region"===b?1:0),a.isTrigger||e("VideoInBacklight","BacklightMode",b)}):d.$("#attr_bl_region_wrap").remove(),d.$("[slider][cfg][key]").slider({min:1,max:100,complete:function(a,b){var c=d.$(a.target);e(c.attr("cfg"),c.attr("key"),b.value)}}),d.$("#attr_ex_ExposureMinBLC,#attr_ex_ExposureMaxBLC").numberfield({min:.1,max:40,allowNegative:!1,allowDecimal:!0,decimalPrecision:3}).blur(function(){var a=d.$("#attr_ex_ExposureMinBLC").numberfield("value"),b=d.$("#attr_ex_ExposureMaxBLC").numberfield("value");a>b&&d.$("#attr_ex_ExposureMaxBLC").numberfield("value",b=a),p.VideoInBacklight[q][r].ExposureMinBLC=a,e("VideoInBacklight","ExposureMaxBLC",b)}),d.$("#attr_ex_GainMinBLC,#attr_ex_GainMaxBLC").numberfield({min:0,max:100,allowNegative:!1,allowDecimal:!1}).blur(function(){var a=d.$("#attr_ex_GainMinBLC").numberfield("value"),b=d.$("#attr_ex_GainMaxBLC").numberfield("value");a>b&&d.$("#attr_ex_GainMaxBLC").numberfield("value",b=a),p.VideoInBacklight[q][r].GainMinBLC=a,e("VideoInBacklight","GainMaxBLC",b)})},render:function(){l.addEvent("RegionChanged",function(a,b,c,d,f){-1===b&&-1===c&&-1===d&&-1===f||0===b&&0===c&&0===d&&0===f||e("VideoInBacklight","BacklightRegion",h([b,c,d,f]))});var b=d.$("[sel-for=onSelBLMode]").empty();if(t.VideoInBacklight.Modes){var c=f("VideoInExposure","AntiFlicker"),i=f("VideoInExposure","Mode"),j=a.grep(t.VideoInBacklight.Modes,function(a){return 0===c&&7!==i&&8!==i&&5!==i||2!==t.VideoInBacklight.WideDynamicRange?!0:"WideDynamic"!==a});a.each(j,function(a,c){b.append("<option value="+c+" t="+g[c]+"></option>")}),b.translation().val(f("VideoInBacklight","Mode")).change()}else b.parent().remove()},leave:function(){l.addEvent("RegionChanged",null),d._showDrawArea(0)},_showDrawArea:function(a){if(l.SetRegionNum(a),a){var b=i(f("VideoInBacklight","BacklightRegion"));l.SetSelRegionByIndex(0,b[0],b[1],b[2],b[3])}},onSelBLMode:function(a){var b=d.$(a.target),c=b.val();return d.$("[slider][key]").parent().hide(),d.$("#attr_bl_region_wrap").hide(),d._showDrawArea(0),a.isTrigger||("Backlight"===c&&"Region"===f("VideoInBacklight","BacklightMode")?p.VideoInBacklight[q][r].Mode=c:e("VideoInBacklight","Mode",c)),d.$("#attr_ex_ExposureMinBLC").parent().hide(),d.$("#attr_ex_GainMaxBLC").parent().hide(),"Backlight"===c?d.$("[name=attr_bl_region]").each(function(a,b){var c=d.$(b);f("VideoInBacklight","BacklightMode")===c.attr("mode")&&c.click().parent().parent().show()}):"WideDynamic"===c?d.$("[slider][key=WideDynamicRange]").slider("value",f("VideoInBacklight","WideDynamicRange")).parent().show():"GlareInhibition"===c&&(d.$("[slider][key=GlareInhibition]").slider("value",f("VideoInBacklight","GlareInhibition")).parent().show(),"Fpga"===t.VideoInBacklight.GlareInhibition&&(d.$("[slider][key=GlareInSensitivity]").slider("value",f("VideoInBacklight","GlareInSensitivity")).parent().show(),d.$("#attr_ex_ExposureMinBLC").numberfield("value",f("VideoInBacklight","ExposureMinBLC")),d.$("#attr_ex_ExposureMaxBLC").numberfield("value",f("VideoInBacklight","ExposureMaxBLC")).parent().show(),d.$("#attr_ex_GainMinBLC").numberfield("value",f("VideoInBacklight","GainMinBLC")),d.$("#attr_ex_GainMaxBLC").numberfield("value",f("VideoInBacklight","GainMaxBLC")).parent().show())),!1}})}),define("attr_whitebalance",function(require,b,c){var d=null,g={Disable:"off",Auto:"Auto",Custom:"w_Customize",Sunny:"Sunny",Cloudy:"cloudy",Home:"home",Office:"office",Night:"Night",HighColorTemperature:"highColorTemperature",LowColorTemperature:"lowColorTemperature",AutoColorTemperature:"autoColorTemperature",CustomColorTemperature:"customColorTemperature",Indoor:"indoor",Outdoor:"w_outdoor",ATW:"track",Manual:"w_Customize",ManualDatum:"manualDatum",AutoOutdoor:"outdoorAutomatic",SodiumAuto:"sodiumAutomatic",Sodium:"sodium",PartWhiteBalance:"partWhiteBalance",Natural:"Sunny",StreetLamp:"Night"};c.exports=k.extend({init:function(){d=this,d.$("#wb_red_slider,#wb_blue_slider").slider({min:0,max:100,complete:function(a,b){var c=d.$(a.target);e(c.attr("cfg"),c.attr("key"),b.value)}});var b=d.$("#attr_wb_mode").empty();a.each(t.VideoInWhiteBalance.Modes,function(a,c){"ManualDatum"!==c&&b.append("<option value="+c+" t="+g[c]+"></option>")}),b.translation().change(function(a){var b=d.$(a.target),c=b.val();return d._showDrawArea(0),"Manual"===c?(d.$("#wb_blue_slider").slider("value",f("VideoInWhiteBalance","GainBlue")).parent().show(),d.$("#wb_red_slider").slider("value",f("VideoInWhiteBalance","GainRed")).parent().show(),a.isTrigger||j.DevVideoInput.getVideoInStatus().done(function(a){d.$("#wb_blue_slider").slider("value",a.GainBlue),d.$("#wb_red_slider").slider("value",a.GainRed),p.VideoInWhiteBalance[q][r].GainBlue=a.GainBlue,p.VideoInWhiteBalance[q][r].GainRed=a.GainRed,e("VideoInWhiteBalance","Mode",c)}).fail(function(){e("VideoInWhiteBalance","Mode",c)})):(d.$("#wb_red_slider,#wb_blue_slider").parent().hide(),a.isTrigger||("ManualDatum"===c?p.VideoInWhiteBalance[q][r].Mode=c:e("VideoInWhiteBalance","Mode",c)),"ManualDatum"===c&&d._showDrawArea(1)),!1})},render:function(){l.addEvent("RegionChanged",function(a,b,c,d,f){-1===b&&-1===c&&-1===d&&-1===f||0===b&&0===c&&0===d&&0===f||e("VideoInWhiteBalance","ManualDatumRect",h([b,c,d,f]))}),d.$("#attr_wb_mode").val(f("VideoInWhiteBalance","Mode")).change()},leave:function(){l.addEvent("RegionChanged",null),d._showDrawArea(0)},_showDrawArea:function(a){if(l.SetRegionNum(a),a){var b=i(f("VideoInWhiteBalance","ManualDatumRect"));l.SetSelRegionByIndex(0,b[0],b[1],b[2],b[3])}}})}),define("attr_daynight",function(require,b,c){var d=null,g={Color:"Colorful",Brightness:"Auto",BlackWhite:"BlackWhite",AlarmInput:"w_Extern Alarm",Photoresistor:"photoresistor",Gain:"gain",IO:"IO"};c.exports=k.extend({init:function(){if(d=this,t.VideoInDayNight.Type?d.$("[name=attr_dn_type]").click(function(a){e("VideoInDayNight","Type",d.$(a.target).attr("dnType"))}):d.$("#attr_dn_type_wrap").remove(),t.VideoInDayNight.Modes&&t.VideoInDayNight.Modes.length){var b=d.$("#attr_dn_mode").empty();a.each(t.VideoInDayNight.Modes,function(a,c){b.append("<option value="+c+" t="+g[c]+"></option>")}),b.translation()}else d.$("#attr_dn_mode").parent().remove();if(t.VideoInDayNight.DelayRange){for(var c=d.$("#attr_dn_delay").empty(),h=t.VideoInDayNight.DelayRange[0];h<=t.VideoInDayNight.DelayRange[1];h++)c.append("<option value="+h+' t="'+h+'+w_secondEx"></option>');c.translation()}else d.$("#attr_dn_delay").parent().remove();d.$("#attr_dn_mode").change(function(a){var b=d.$(a.target),c=b.val();return"Brightness"===c?(d.$("#attr_dn_sen").val(f("VideoInDayNight","Sensitivity")).parent().show(),d.$("#attr_dn_delay").val(f("VideoInDayNight","Delay")).parent().show()):d.$("#attr_dn_sen,#attr_dn_delay").parent().hide(),a.isTrigger||e(b.attr("cfg"),b.attr("key"),c),!1}),d.$("#attr_dn_sen,#attr_dn_delay").change(function(a){var b=d.$(a.target);return e(b.attr("cfg"),b.attr("key"),b.val()-0),!1})},render:function(){d.$("[name=attr_dn_type]").each(function(a,b){var c=d.$(b);c.prop("checked",f("VideoInDayNight","Type")===c.attr("dnType"))}),d.$("#attr_dn_mode").each(function(a,b){d.$(b).val(f("VideoInDayNight","Mode")).change()})}})}),define("attr_zoomfocus",function(require,b,c){var d=null;c.exports=k.extend({init:function(){d=this,t.VideoInZoom&&t.VideoInZoom.DigitalZoomSupport?d.$("[name=attr_zf_DZ]").click(function(a){var b=d.$(a.target);e("VideoInZoom","DigitalZoom",!b.is("[off]"))}):d.$("#attr_zf_DZ_wrap").remove(),t.VideoInFocus&&-1!==a.inArray("AutoTrace",t.VideoInFocus.Focus)?d.$("[name=attr_zf_AFT]").click(function(a){var b=d.$(a.target);e("VideoInFocus","AutoFocusTrace",b.is("[off]")?0:1)}):d.$("#attr_zf_AFT_wrap").remove(),d.$("[slider][key=Speed]").slider({min:0,max:100,complete:function(a,b){e("VideoInZoom","Speed",b.value)}});var b=d.$("[sel-for=onSelectLimit]").empty();if(t.VideoInFocus&&t.VideoInFocus.FocusLimit){t.VideoInFocus.FocusLimitSelectMode&&-1!==a.inArray("Auto",t.VideoInFocus.FocusLimitSelectMode)&&b.append('<option value="Auto" t="Auto"></option>');
var c=t.VideoInFocus.FocusLimitRange||[100,1e3,2e3,3e3,5e3];a.each(c,function(a,c){b.append(100===c?"<option value=100>10cm</option>":c%10===1?"<option value="+c+">"+(c-1)/1e3+"m+</option>":"<option value="+c+">"+c/1e3+"m</option>")}),b.translation()}else b.parent().remove();t.VideoInFocus&&t.VideoInFocus.Sensitivity||d.$("#attr_zf_sen").parent().remove(),t.VideoInFocus&&t.VideoInFocus.Modes||d.$("#attr_zf_mode").parent().remove(),m.get("PTZCaps").done(function(a){a&&a.SupportLensInit||d.$("[btn-for=onLensInit]").parent().remove()}),d.$("#attr_zf_mode,#attr_zf_sen").change(function(a){var b=d.$(a.target);return e(b.attr("cfg"),b.attr("key"),b.val()-0),!1})},onSelectLimit:function(a){var b=d.$(a.target),c=b.val();return"Auto"===c?e("VideoInFocus","FocusLimitSelectMode","Auto"):(p.VideoInFocus[q][r].FocusLimitSelectMode="Manual",e("VideoInFocus","FocusLimit",c-0)),!1},onLensInit:function(){j.PTZ.lensInit()},render:function(){d.$("[name=attr_zf_DZ]").each(function(a,b){var c=d.$(b);c.prop("checked",f("VideoInZoom","DigitalZoom")!==c.is("[off]"))}),d.$("[name=attr_zf_AFT]").each(function(a,b){var c=d.$(b);c.prop("checked",!!f("VideoInFocus","AutoFocusTrace")!==c.is("[off]"))}),d.$("[slider][cfg][key]").each(function(a,b){var c=d.$(b);c.slider("value",f(c.attr("cfg"),c.attr("key")))}),d.$("[sel-for=onSelectLimit]").each(function(a,b){var c=d.$(b);c.val("Auto"===f("VideoInFocus","FocusLimitSelectMode")?"Auto":f("VideoInFocus","FocusLimit"))}),d.$("#attr_zf_mode,#attr_zf_sen").each(function(a,b){var c=d.$(b),e=c.attr("key"),g=c.attr("cfg");c.val(f(g,e))})}})}),define("attr_light",function(require,b,c){var d=null,e={Manual:"w_Manual",Auto:"w_SmartIR",Off:"w_off",ZoomPrio:"w_zoomPrio",Timing:"w_Timing"},f={FarLight:[0,0,0,0],NearLight:[0,0,0,0],MiddleLight:[0,0,0,0]},g=0;c.exports=k.extend({init:function(){if(d=this,t.LightingControl.Power){var b=t.LightingControl.Power[1],c=t.LightingControl.Power[0],h=t.LightingControl.Power[2];c&&1&c&&(f.NearLight[0]=1),c&&2&c&&(f.NearLight[1]=1),c&&4&c&&(f.NearLight[2]=1),c&&8&c&&(f.NearLight[3]=1),b&&1&b&&(f.FarLight[0]=1),b&&2&b&&(f.FarLight[1]=1),b&&4&b&&(f.FarLight[2]=1),b&&8&b&&(f.FarLight[3]=1),h&&1&h&&(f.MiddleLight[0]=1),h&&2&h&&(f.MiddleLight[1]=1),h&&4&h&&(f.MiddleLight[2]=1),h&&8&h&&(f.MiddleLight[3]=1)}var i=d.$("#attr_light_mode").empty();if(a.each(t.LightingControl.Modes,function(a,b){i.append("<option value="+b+" t="+e[b]+"></option>")}),i.translation().change(d._modeChange),t.LightingControl.Correction&&t.LightingControl.Correction.Support||d.$("[slider][key=Correction]").parent().remove(),t.LightingControl.NearLightNumber)if(1===t.LightingControl.NearLightNumber?(d.$("[slider][key1=NearLight][index=1]").parent().remove(),d.$("[slider][key1=NearLight][index=2]").parent().remove(),d.$("[slider][key1=NearLight][index=3]").parent().remove()):2===t.LightingControl.NearLightNumber?(d.$("[slider][key1=NearLight][index=2]").parent().remove(),d.$("[slider][key1=NearLight][index=3]").parent().remove()):3===t.LightingControl.NearLightNumber&&d.$("[slider][key1=NearLight][index=3]").parent().remove(),t.LightingControl.AngleControl&&t.LightingControl.AngleControl[0]){var k=t.LightingControl.AngleControl[0];1&k||d.$("[slider][key1=NearLight][index=0][key2=Angle]").parent().remove(),2&k||d.$("[slider][key1=NearLight][index=1][key2=Angle]").parent().remove(),4&k||d.$("[slider][key1=NearLight][index=2][key2=Angle]").parent().remove(),8&k||d.$("[slider][key1=NearLight][index=3][key2=Angle]").parent().remove()}else d.$("[slider][key1=NearLight][key2=Angle]").parent().remove();else d.$("[slider][key1=NearLight]").parent().remove();if(t.LightingControl.MiddleLightNumber)if(1===t.LightingControl.MiddleLightNumber?(d.$("[slider][key1=MiddleLight][index=1]").parent().remove(),d.$("[slider][key1=MiddleLight][index=2]").parent().remove(),d.$("[slider][key1=MiddleLight][index=3]").parent().remove()):2===t.LightingControl.MiddleLightNumber?(d.$("[slider][key1=MiddleLight][index=2]").parent().remove(),d.$("[slider][key1=MiddleLight][index=3]").parent().remove()):3===t.LightingControl.MiddleLightNumber&&d.$("[slider][key1=MiddleLight][index=3]").parent().remove(),t.LightingControl.AngleControl&&t.LightingControl.AngleControl[2]){var l=t.LightingControl.AngleControl[2];1&l||d.$("[slider][key1=MiddleLight][index=0][key2=Angle]").parent().remove(),2&l||d.$("[slider][key1=MiddleLight][index=1][key2=Angle]").parent().remove(),4&l||d.$("[slider][key1=MiddleLight][index=2][key2=Angle]").parent().remove(),8&l||d.$("[slider][key1=MiddleLight][index=3][key2=Angle]").parent().remove()}else d.$("[slider][key1=MiddleLight][key2=Angle]").parent().remove();else d.$("[slider][key1=MiddleLight]").parent().remove();if(t.LightingControl.FarLightNumber)if(1===t.LightingControl.FarLightNumber?(d.$("[slider][key1=FarLight][index=1]").parent().remove(),d.$("[slider][key1=FarLight][index=2]").parent().remove(),d.$("[slider][key1=FarLight][index=3]").parent().remove()):2===t.LightingControl.FarLightNumber?(d.$("[slider][key1=FarLight][index=2]").parent().remove(),d.$("[slider][key1=FarLight][index=3]").parent().remove()):3===t.LightingControl.FarLightNumber&&d.$("[slider][key1=FarLight][index=3]").parent().remove(),t.LightingControl.AngleControl&&t.LightingControl.AngleControl[1]){var m=t.LightingControl.AngleControl[1];1&m||d.$("[slider][key1=FarLight][index=0][key2=Angle]").parent().remove(),2&m||d.$("[slider][key1=FarLight][index=1][key2=Angle]").parent().remove(),4&m||d.$("[slider][key1=FarLight][index=2][key2=Angle]").parent().remove(),8&m||d.$("[slider][key1=FarLight][index=3][key2=Angle]").parent().remove()}else d.$("[slider][key1=FarLight][key2=Angle]").parent().remove();else d.$("[slider][key1=FarLight]").parent().remove();d.$("[slider][cfg][key=Correction]").slider({min:0,max:100,complete:function(a,b){p.Lighting[q][g].Correction=b.value,j.ConfigManager.setTemporaryConfig("Lighting",p.Lighting)}}),d.$("[slider][cfg][key1][index][key2]").slider({min:0,max:100,complete:function(a,b){var c=d.$(a.target),e=c.attr("cfg"),h=c.attr("key1"),i=c.attr("index")-0,k=c.attr("key2"),l=b.value;"Light"===k&&f[h][i]&&(l=d._fixValue(b.value),c.slider("value",l)),p[e][q][g][h][i][k]=l,j.ConfigManager.setTemporaryConfig(e,p[e])}})},_fixValue:function(b){var c=0;return a.each(f.FarLight,function(a,b){b&&(c+=d.$("[slider][cfg][key1=FarLight][index="+a+"][key2=Light]").slider("value"))}),a.each(f.NearLight,function(a,b){b&&(c+=d.$("[slider][cfg][key1=NearLight][index="+a+"][key2=Light]").slider("value"))}),a.each(f.MiddleLight,function(a,b){b&&(c+=d.$("[slider][cfg][key1=MiddleLight][index="+a+"][key2=Light]").slider("value"))}),c>100?b-(c-100):b},render:function(){d.$("#attr_light_mode").val(p.Lighting[q][g].Mode).change()},_modeChange:function(a){var b=d.$(a.target),c=b.val();a.isTrigger||(p.Lighting[q][g].Mode=c,j.ConfigManager.setTemporaryConfig("Lighting",p.Lighting)),"ZoomPrio"===c?(d.$("[slider][key=Correction]").each(function(a,b){d.$(b).slider("value",p.Lighting[q][g].Correction).parent().show()}),d.$("[slider][key1][index][key2]").parent().hide()):"Manual"===c?(d.$("[slider][key=Correction]").parent().hide(),d.$("[slider][key1][index][key2]").each(function(a,b){var c=d.$(b),e=c.attr("cfg"),f=c.attr("key1"),a=c.attr("index")-0,h=c.attr("key2");c.slider("value",p[e][q][g][f][a][h]).parent().show()})):d.$("[slider]").parent().hide()}})}),define("attr_defog",function(require,b,c){var d=null,g={Off:"Off",Auto:"Auto",Manual:"Manul"},h={Off:"off",Auto:"Auto",Manual:"Manual"};c.exports=k.extend({init:function(){d=this;var b=d.$("[sel-for=onSelectDefogMode]");t.VideoInDefog.Modes&&t.VideoInDefog.Modes.length>0?(b.empty(),a.each(t.VideoInDefog.Modes,function(a,c){b.append("<option value="+g[c]+" t="+h[c]+"></option>")}),b.translation()):b.parent().remove(),t.VideoInDefog.LightIntensity&&t.VideoInDefog.LightIntensity.Support?d.$("#attr_defog_grade").slider({min:0,max:100,complete:function(a,b){e("VideoInDefog","LightIntensityLevel",b.value)}}):(d.$("[sel-for=onSelectLightMode]").parent().remove(),d.$("#attr_defog_grade").parent().remove())},render:function(){var a=d.$("[sel-for=onSelectDefogMode]");a.val(f(a.attr("cfg"),a.attr("key"))).change()},onSelectDefogMode:function(a){var b=d.$(a.target),c=b.val();return"Manul"===c?(d.$("[sel-for=onSelectIntensity]").val(f("VideoInDefog","Intensity")).parent().show(),d.$("[sel-for=onSelectLightMode]").val(f("VideoInDefog","LightIntensityMode")).change().parent().show()):d.$("[sel-for=onSelectIntensity],[sel-for=onSelectLightMode],#attr_defog_grade").parent().hide(),a.isTrigger||e(b.attr("cfg"),b.attr("key"),c),!1},onSelectIntensity:function(a){var b=d.$(a.target);return e(b.attr("cfg"),b.attr("key"),b.val()-0),!1},onSelectLightMode:function(a){var b=d.$(a.target),c=b.val();return"Manul"===c?d.$("#attr_defog_grade").slider("value",f("VideoInDefog","LightIntensityLevel")).parent().show():d.$("#attr_defog_grade").parent().hide(),a.isTrigger||e(b.attr("cfg"),b.attr("key"),c),!1}})}),define("attr_ldc",function(require,a,b){var c=null;b.exports=k.extend({init:function(){c=this,c.$("[name=attr_ldc_Cor]").click(function(a){var b=c.$(a.target),d=b.attr("cfg");a.isTrigger||(p[d][q][b.attr("key")]=!b.is("[off]"),j.ConfigManager.setTemporaryConfig(d,p[d]))})},render:function(){c.$("[name=attr_ldc_Cor]").each(function(a,b){var d=c.$(b),e=d.attr("cfg"),f=d.attr("key");p[e][q][f]!==d.is("[off]")&&d.click()})}})}),define("attr_LightGlobal",function(require,a,b){var c,d=null;b.exports=k.extend({init:function(){d=this,d._renderElements()},_renderElements:function(){j.ConfigManager.getConfig("LightGlobal").done(function(a){c=a,1==c[0].Enable&&d.$("[sel-for=attr_LightGlobal_mode]").val(0),0==c[0].Enable&&d.$("[sel-for=attr_LightGlobal_mode]").val(1)})}})})}),define("camera_cfg",function(require,b,c){var d=require("jsCore/rpc"),e=require("jsCore/pageBase");require("jsCore/modules/timeDrag");var f=null,g=null,h=0;c.exports=e.extend({init:function(){f=this,f.$("[name=cfg_mode]").click(function(b){var c=a(b.target),d=c.attr("mode");f.$("[mode-for][mode-for!="+d+"]").hide(),f.$("[mode-for="+d+"]").show()}),f.$("#cfg_timeDrag").timeDrag(),f.render()},render:function(){f._getConfig(!1)},onRefresh:function(){return f._getConfig(!0),!1},onDefault:function(){return d.ConfigManager.getDefault("VideoInMode").done(function(a){g=a,f._render(),f.tip("success","Defaultsuccess")}).fail(function(){f.tip("error","Defaultfailure")}),!1},onSave:function(){g[h].Config.length=0;var a=f.$("[name=cfg_mode]:checked").attr("mode");if("fulltime"===a)g[h].Mode=0,g[h].Config[0]=f.$("#cfg_daynight").val()-0,g[h].TimeSection[0][1]="0 00:00:00-23:59:59";else if("normal"===a)g[h].Mode=0,g[h].Config[0]=2,g[h].TimeSection[0][1]="0 00:00:00-23:59:59";else if("switch"===a){g[h].Mode=1,g[h].Config.push(0),g[h].Config.push(1);var b=f.$("#cfg_timeDrag").timeDrag("startTime"),c=f.$("#cfg_timeDrag").timeDrag("endTime");if(b===c)return f.tip("warning","SunTimeError");g[h].TimeSection[0][0]="1 "+b+"-"+c,g[h].TimeSection[0][1]="0 00:00:00-00:00:00"}return d.ConfigManager.setConfig("VideoInMode",g).done(function(){f.tip("success","Succeed in saving configure")}).fail(function(){f.tip("error","Saving failure")}),!1},_getConfig:function(a){d.ConfigManager.getConfig("VideoInMode").done(function(b){g=b,f._render(),a&&f.tip("success","Operateingsuccess")}).fail(function(){f.tip("error","Operateingfailure")})},_render:function(){if(f.$("#cfg_daynight").val(0),0===g[h].Mode)switch(g[h].Config[0]){case 0:f.$("[mode=fulltime]").prop("checked",!0).click();break;case 1:f.$("[mode=fulltime]").prop("checked",!0).click(),f.$("#cfg_daynight").val(1);break;case 2:f.$("[mode=normal]").prop("checked",!0).click()}else f.$("[mode=switch]").prop("checked",!0).click();var a=g[h].TimeSection[0][0].split(" ")[1];f.$("#cfg_timeDrag").timeDrag("startTime",a.split("-")[0]),f.$("#cfg_timeDrag").timeDrag("endTime",a.split("-")[1])}})}),define("camera_focus",function(require,a,b){require("jsCore/modules/zoomFocus");var c=require("jsCore/pageBase"),d=null;b.exports=c.extend({init:function(){d=this,d.$("#c_f_zoomfocus").zoomFocus(),d.render()},render:function(){plugin.cover("#c_f_video",function(a){plugin.SetRegionNum(0),plugin.SetModuleMode(1),plugin.open(),a&&d.$("#c_f_zoomfocus").zoomFocus("render")}),d.$("#c_f_zoomfocus").zoomFocus("render")},leave:function(){d.$("#c_f_zoomfocus").zoomFocus("leave"),plugin.hide()}})}),define("camera_steady",function(require,a,b){var c=require("jsCore/rpc"),d=require("jsCore/pageBase"),e=require("jsCore/modules/timeSection"),f=null,g=null,h=null,i=null,j=null,k={};b.exports=d.extend({init:function(){f=this,g=f.$("[sel-for=onSteadyMode]"),h=f.$("#camera_steady_timeM"),i=f.$("#camera_steady_holdM"),j=f.$("[cfg=Bright]").numberfield({min:1,max:255,allowDecimal:!1,allowNegative:!1}),f.$("input[id^=camera_steady_]").click(f.onRadio),g.on("change",f._setModeOptions),f.render()},render:function(){f._getConfig(!1)},onSteadytmSet:function(){return k[1][0]&&k[1][0].Config&&k[1][0].Config.TimeSection&&e.open(k[1][0].Config.TimeSection).done(function(a){k[1][0].Config.TimeSection=a}),!1},onRadio:function(){var a=h.is(":checked"),b=i.is(":checked");a&&(f.$("#camera_steady_bright_wrap").show(),f.disabled("#camera_steady_bright_wrap",!1),f.$("#camera_steady_time_wrap").show(),h.prop("checked",!0),k[1][0].Config.AutoMode="Timing"),b&&(f.$("#camera_steady_bright_wrap").hide(),f.$("#camera_steady_time_wrap").hide(),i.prop("checked",!0),k[1][0].Config.AutoMode="Brightness")},onRefresh:function(){return f._getConfig(!0),!1},onDefault:function(){return c.ConfigManager.getDefault("DHRS").done(function(a){k=a,f._setModeOptions(),f._renderElements(),f.tip("success","Defaultsuccess")}).fail(function(){f.tip("error","Defaultfailure")}),!1},onConfirm:function(){return f._saveData(),c.ConfigManager.setConfig("DHRS",k).done(function(){f.tip("success","Succeed in saving configure")}).fail(function(){f.tip("error","Saving failure")}),!1},_getConfig:function(a){c.ConfigManager.getConfig("DHRS").done(function(b){k=b,f._renderElements(),a&&f.tip("success","Operateingsuccess")}).fail(function(){f.tip("error","Operateingfailure")})},_renderElements:function(){"Timing"==k[1][0].Config.AutoMode?h.prop("checked",!0):i.prop("checked",!0),"Close"==k[1][0].Config.Mode?(g.val("Close"),f.$("#camera_steady_bright_wrap").show(),f.disabled("#camera_steady_bright",!0),f.$("#camera_steady_auto_wrap").hide(),f.$("#camera_steady_time_wrap").hide()):"Open"==k[1][0].Config.Mode?(g.val("Open"),f.$("#camera_steady_bright_wrap").show(),f.disabled("#camera_steady_bright",!1),f.$("#camera_steady_time_wrap").hide()):"Auto"==k[1][0].Config.Mode&&(g.val("Auto"),f.$("#camera_steady_auto_wrap").show(),h.prop("checked")?(f.$("#camera_steady_bright_wrap").show(),f.disabled("#camera_steady_bright",!1),f.$("#camera_steady_time_wrap").show()):(f.$("#camera_steady_bright_wrap").hide(),f.disabled("#camera_steady_bright",!1),f.$("#camera_steady_time_wrap").hide())),f.$("#camera_steady_bright").numberfield("value",k[1][0].Config.Brightness),"Timing"==k[1][0].Config.AutoMode&&h.prop("checked",!0)||i.prop("checked",!0)},_setModeOptions:function(){"Close"==g.val()?(f.$("#camera_steady_bright_wrap").show(),f.disabled("#camera_steady_bright",!0),f.$("#camera_steady_auto_wrap").hide(),f.$("#camera_steady_time_wrap").hide()):"Open"==g.val()?(f.$("#camera_steady_bright_wrap").show(),f.disabled("#camera_steady_bright",!1),f.$("#camera_steady_auto_wrap").hide(),f.$("#camera_steady_time_wrap").hide()):(f.$("#camera_steady_auto_wrap").show(),h.prop("checked")?(f.$("#camera_steady_bright_wrap").show(),f.disabled("#camera_steady_bright",!1),f.$("#camera_steady_time_wrap").show()):(f.$("#camera_steady_bright_wrap").hide(),f.disabled("#camera_steady_bright",!1),f.$("#camera_steady_time_wrap").hide()))},_saveData:function(){f._setModeOptions(),k[1][0].Config.Mode=g.val(),"Timing"==k[1][0].Config.AutoMode?h.prop("checked",!0):i.prop("checked",!0),k[1][0].Config.Brightness=f.$("#camera_steady_bright").numberfield("value")}})}),define("camera_flick",function(require,b,c){var d=require("jsCore/rpc"),e=require("jsCore/pageBase"),f=require("jsCore/plugin"),g=require("jsCore/ability");common=require("common/common"),require("widget/js/dui.slider");var h,i=null,j=0,k=0,l="",m={};c.exports=e.extend({init:function(){i=this,i.$("#flick_nY").numberfield({min:0,max:8191,allowDecimal:!1,allowNegative:!1}).blur(function(){i._pluginChange()}),f.CheckFuncSupport(2).done(function(b){b?a("#c_f_fullscreen").show():a("#c_f_fullscreen").hide()}),i.$("input[mode]").click(i.onRadio),i._initSlider(),i.render()},render:function(){f.cover("#flick_video",function(){f.SetRegionNum(0),f.SetModuleMode(1),f.EnableVideoAnalyseModule(!0),f.open()}),f.addEvent("VideoAnalyzeConfig",function(a){k=JSON.parse(a).EventParam.ShapeID,f.GetVideoAnalyseShapeConfigData(k).done(function(a){a&&(a=JSON.parse(a).Line1[0][1],i.$("#flick_nY").numberfield("value",a))})}),i._getConfig(!1)},_pluginChange:function(){f.DeleteAllVideoAnalyseShape(),h=i.$("#flick_nY").numberfield("value"),l='{"Line1":[[0,'+h+"],[8191,"+h+"]]}",f.CreateMainVideoAnalyseShape(0,"LineShapeEvent","LineShape","Line1",l,"MovedHLine").done(function(){})},_getConfig:function(a){d.ConfigManager.getConfig("VideoInFlicker").done(function(b){m=b,i._render(),a&&i.$("#flicker_tip").tip("success",tl("Operateingsuccess"))}).fail(function(){i.$("#flicker_tip").tip("error",tl("Operateingfailure"))})},_render:function(){i.$("[data]").each(function(a,b){var c=i.$(b),d=c.attr("key");c.slider("value",parseInt(m[0][d][a]))}),"Open"==m[0].Mode&&i.$("[mode=on]").prop("checked",!0),"Close"==m[0].Mode&&i.$("[mode=off]").prop("checked",!0),"Auto"==m[0].Mode&&i.$("[mode=auto]").prop("checked",!0),i.$("#flick_nY").numberfield("value",m[0].YCoordinate[0]),i._pluginChange()},_initSlider:function(){g.get("VideoInputCapsEx").always(function(a){j=a&&a.Flicker&&a.Flicker.MaxAmplitude,i.$("[data]").slider({min:0,max:j||64,complete:function(a,b){var c=i.$(a.target);m[0].Amplitude[parseInt(c.attr("data"))]=b.value}})})},onFullScreen:function(){return f.SetFullScreen(),!1},leave:function(){f.addEvent("VideoAnalyzeConfig",null),f.DeleteAllVideoAnalyseShape(),f.hide()},onRadio:function(){i.$("[mode=on]").prop("checked")?m[0].Mode="Open":i.$("[mode=off]").prop("checked")?m[0].Mode="Close":i.$("[mode=auto]").prop("checked")&&(m[0].Mode="Auto")},onDefault:function(){d.ConfigManager.getDefault("VideoInFlicker").done(function(a){m=a,i._render(),i.$("#flicker_tip").tip("success",tl("Defaultsuccess"))}).fail(function(){i.$("#flicker_tip").tip("error",tl("Defaultfailure"))})},onRefresh:function(){i._getConfig(!0)},onSave:function(){m[0].YCoordinate[0]=i.$("#flick_nY").numberfield("value"),m[0].YCoordinate[1]=i.$("#flick_nY").numberfield("value"),d.ConfigManager.setConfig("VideoInFlicker",m).done(function(){i.$("#flicker_tip").tip("success",tl("Succeed in saving configure"))}).fail(function(){i.$("#flicker_tip").tip("error",tl("Saving failure"))})}})}),define("camera_matrixSwitch",function(require,a,b){var c=require("jsCore/rpc"),d=require("jsCore/pageBase"),e=null,f={};b.exports=d.extend({init:function(){e=this,$matrixSwitch=e.$("[sel-for=onSelMatrixSwitch]"),$matrixSwitch.on("change",e._setMatrixSwitch),e.render()},render:function(){e._getConfig(!1)},onRefresh:function(){return e._getConfig(!0),!1},onDefault:function(){return c.ConfigManager.getDefault("CSCMatrixSwitch").done(function(a){f=a,e._renderElements(),e.tip("success","Defaultsuccess")}).fail(function(){e.tip("error","Defaultfailure")}),!1},onConfirm:function(){return e._setMatrixSwitch(),c.ConfigManager.setConfig("CSCMatrixSwitch",f).done(function(){e.tip("success","Succeed in saving configure")}).fail(function(){e.tip("error","Saving failure")}),!1},_getConfig:function(a){c.ConfigManager.getConfig("CSCMatrixSwitch").done(function(b){f=b,e._renderElements(),a&&e.tip("success","Operateingsuccess")}).fail(function(){e.tip("error","Operateingfailure")})},_renderElements:function(){"BT601"===f[0].RGBTOYUVMatrix?$matrixSwitch.val("BT601"):"BT709"===f[0].RGBTOYUVMatrix&&$matrixSwitch.val("BT709")},_setMatrixSwitch:function(){"BT601"===$matrixSwitch.val()?f[0].RGBTOYUVMatrix="BT601":"BT709"===$matrixSwitch.val()&&(f[0].RGBTOYUVMatrix="BT709")}})})}(jQuery);