!function(a){define(function(require,a,b){b.exports=require("jsCore/pageTab")}),define("PPPoE",function(require,b,c){var d,e,f,g,h,i,j=require("jsCore/rpc"),k=require("jsCore/pageBase"),l=require("common/common").Check;c.exports=k.extend({init:function(){var b=this;d=b.$("#pppoe_enable"),e=b.$("#pppoe_username").textfield(),f=b.$("#pppoe_password").textfield(),g=a.validator([{element:e,check:[l.noQuotation,l.noQuotation],errorMsg:[tl("w_noInputMarks"),tl("w_noInputMarks")],events:["keyup","blur"]},{element:f,check:[l.noQuotation,l.noQuotation],errorMsg:[tl("w_noInputMarks"),tl("w_noInputMarks")],events:["keyup","blur"]}]),b.render()},render:function(){this._getConfig()},_getConfig:function(a){var b=this;j.ConfigManager.getConfig("PPPoE").done(function(c){h=c,b._renderElement(),b.disabled("[btn-for=onSave]",!1),a&&b.tip("success","Operateingsuccess")}).fail(function(){b.disabled("[btn-for=onSave]",!0),b.tip("error","Operateingfailure")})},_renderElement:function(){var a=this;d.prop("checked",h.Enable),e.textfield("value",h.UserName),f.textfield("value",h.Password),g.validate(),a.$("#pppoe_ip").closest(".ui-form-item").hide(),clearInterval(i),h.Enable&&j.NetApp.getNetInterfaces().done(function(b){i=setInterval(function(){a._getRegistedIP(b[0].Name)},5e3)})},_getRegistedIP:function(a){var b=this;j.NetApp.getDialInfo(a).done(function(a){a&&a.IPAddress&&(b.$("#pppoe_ip").text(a.IPAddress).closest(".ui-form-item").show(),clearInterval(i))})},onSave:function(){var a=this;return g.isInvalid()?a.tip("warning",g.errors()[0].errorMsg):(h.Enable=d.prop("checked"),h.UserName=e.textfield("value"),h.Password=f.textfield("value"),j.ConfigManager.setConfig("PPPoE",h).done(function(){a._getConfig(),a.tip("success","Succeed in saving configure")}).fail(function(){a.tip("error","Saving failure")}),!1)},onRefresh:function(){var a=this;return a._getConfig(!0),!1},onDefault:function(){var a=this;return j.ConfigManager.getDefault("PPPoE").done(function(b){h=b,a._renderElement(),a.disabled("[btn-for=onSave]",!1),a.tip("success","Defaultsuccess")}).fail(function(){a.disabled("[btn-for=onSave]",!0),a.tip("error","Defaultfailure")}),!1}})})}(jQuery);